!function(){"use strict";function a(a){function b(b,c,d,e){function f(){b.hasmask=b.hasmask,b.modelEmail=b.modelEmail,e.$validators.invalidEmail=g,c.on("change",h)}function g(d){return!(void 0!==d&&""!==d&&!b.hasmask)||a.isValidCP(d,c[0].id)}function h(c){b.hasmask=!1,a.isValid(c.currentTarget.value)&&(e.$setValidity("invalidEmail",!0),b.$apply())}f()}return{restrict:"A",require:"ngModel",scope:{hasmask:"=",modelEmail:"=ngModel"},link:b}}a.$inject=["emailValidationFactory"],angular.module("internetBanking.loan").directive("bvInputEmailWithMask",a)}(),function(){"use strict";function a(a){function b(b,c,d,e){function f(){b.hasmask=b.hasmask,b.modelMobile=b.modelMobile,e.$validators.phoneMobile=g,c.on("change",h)}function g(c){return!(void 0!==c&&""!==c&&!b.hasmask)||a.isValid(c)}function h(c){b.hasmask=!1,a.isValid(c.currentTarget.value)&&(e.$setValidity("phoneMobile",!0),b.$apply())}f()}return{restrict:"A",require:"ngModel",scope:{hasmask:"=",modelMobile:"=ngModel"},link:b}}a.$inject=["mobileValidationFactory"],angular.module("internetBanking.loan").directive("bvInputMobileWithMask",a)}(),function(){"use strict";function a(){function a(a,b,c,d){function e(b,c){return!!a.hasmask||(g(b)||!i(c))}function f(b,c){return!!a.hasmask||(g(b)||!j(c))}function g(a){return void 0===a||""===a}function h(a){return a.length>9&&moment(a,"DD/MM/YYYY","pt-BR",!0).isValid()}function i(a){return(h(a)?l(a):0)<=m}function j(a){return(h(a)?l(a):0)>=n}function k(a){var b=a.slice(0,2),c=parseInt(a.slice(3,5))-1,d=a.slice(6,10);return moment([d,c,b])}function l(a){return moment().diff(k(a),"years",!0)}var m=c.minAge||16,n=c.maxAge||100;a.hasmask=a.hasmask,a.modelBirthDate=a.modelBirthDate,d.$validators.minorAge=e,d.$validators.overAge=f}return{restrict:"A",require:"?ngModel",scope:{hasmask:"=",modelBirthDate:"=ngModel"},link:a}}angular.module("internetBanking.loan").directive("bvInputBirthDateWithMask",a)}(),function(){"use strict";function a(a,b){function c(c,d,e,f){function g(a){var c,e=b.findElement(d[0].id);return c=void 0===e||e.changed?a?a.replace(/[^0-9()\- ]/g,""):"":a?a.replace(/[^0-9()\-*\u2022 ]/g,""):"",c!==a&&(f.$setViewValue(c),f.$render()),c}function h(){c.modelMobile=c.modelMobile,f.$validators.phoneValidation=i}function i(b){return!(void 0!==b&&""!==b)||0==b.length||a.isValid(b)}return h(),!!f&&f.$parsers.push(g)}return{restrict:"AE",require:"ngModel",scope:{modelMobile:"=ngModel"},link:c}}a.$inject=["phoneValidationFactory","inputMaskChangedFactory"],angular.module("internetBanking.loan").directive("bvInputPhone",a)}(),function(){"use strict";function a(a){function b(a){d=a,d.modalConfig={open:!1},d.showWpp=!1,d.teste="HAHAHAHA",d.openModal=c,document.showLoanWpp&&(d.showWpp=!0)}function c(){d.modalConfig.open=!0}var d={};return{restrict:"E",link:b,templateUrl:a.LOAN_WHATSAPP,scope:{url:"@"}}}a.$inject=["loanTemplateUrls"],angular.module("internetBanking.loan").directive("bvWhatsApp",a)}(),function(){"use strict";function a(a,b){function c(){b.$on("$destroy",function(){a.stopRenewSession()})}c()}a.$inject=["inactivityService","$scope"],angular.module("internetBanking.loan").controller("LoanController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(){l(),m(),i(),k()}function i(){r.onEditMonthlyIncome=n,r.onConfirmIncome=o}function j(){function a(a){document.contractCPByPdec=!0,p(),g.set(a.data),c.go(b.SIMULATOR)}function d(a){r.quantityErrorsPDEC++,p(),r.quantityErrorsPDEC>1?(document.contractCPByPdec=!1,g.shutDown(),c.go(b.SIMULATOR)):(r.modalStatus.open=!0,r.confirmedIncome=!1)}q(),f.get(r.modelIncome.monthlyIncome).then(a).catch(d)}function k(){function a(a){e.set(a.data);var b,c=a.data.dadosClienteRendas;b=null!=c&&c.length>0?c.length>1?c.sort(function(a,b){return a.valor<b.valor})[0].valor:c[0].valor:0,r.modelIncome.monthlyIncome=b,p()}function b(a){p()}q(),g.initialized(),d.get().then(a).catch(b)}function l(){r.formIncome={},r.valueMinIncome=1,r.modelIncome={monthlyIncome:0},r.editMonthIncome=!1,r.confirmedIncome=!1,r.valueMaxSimulator=0,r.valueMinSimulator=300,r.loadingPage=!0,r.watchEvent=!0,r.view={formatMoney:a.formatMoney},r.modalStatus={open:!1},r.quantityErrorsPDEC=0}function m(){r.modelIncome.monthlyIncome<r.valueMinIncome&&(r.editMonthIncome=!0)}function n(){r.confirmedIncome||(r.editMonthIncome=!0)}function o(){r.formIncome.$valid&&(r.confirmedIncome=!0,r.editMonthIncome=!1,j())}function p(){r.loadingPage=!1,r.loadingSideBar=!1}function q(){r.loadingPage=!0,r.loadingSideBar=!0}var r=this;h()}a.$inject=["loanUtilsFactory","loanRoutes","$state","cpDataUserMask","dataUserFactory","PDECService","pdecFactory"],angular.module("internetBanking.loan").controller("ConfirmIncomeController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){j(),k(),e.reset(),l(),m(),h.callCustomPageView("","/status-da-proposta"),s()}function j(){t.loanRoutes=b,t.commonRoutes=c,t.loadingPage=!0,t.watchEvent=!0,t.withMessage=!0,t.countAttempts=0,t.modalConfig={open:!1,error:{open:!1}}}function k(){t.onClickGoHome=q}function l(){e.set("nameUser",f.user.user)}function m(){function a(a){n(a)}function b(){if(t.countAttempts<2)return t.countAttempts++,void r();p(),t.loadingPage=!1}d.check().then(a).catch(b)}function n(c){var d,e="",f=document.showLoanSimulatorV2||!1,g=document.showConfirmIncome||!1;d=g?"CONFIRM_INCOME":f?"SIMULATOR_V2":"SIMULATOR",204===c.status?e=b[d]:(c.data.hasOwnProperty("status")&&"APA"==c.data.status.toUpperCase()&&(e=b.CONTRACT_PAYMENT_SUCCESS),e=c.data.hasOwnProperty("statusProposta")?"A"==c.data.statusProposta.toUpperCase()?b.CONTRACT_SEND_DOCUMENTS:"AP"==c.data.statusProposta.toUpperCase()?b.CONTRACT_PAYMENT_PENDING:o(c.data.status):o(c.data.status)),a.go(e)}function o(a){var c=document.showLoanSimulatorV2||!1,d=c?"SIMULATOR_V2":"SIMULATOR";return b[{NLOC:d,DOCS:"CONTRACT_SEND_DOCUMENTS",AC:"CONTRACT_TENDER_ANALYZED",AI:"CONTRACT_TENDER_ANALYZED",ACOM:"CONTRACT_TENDER_ANALYZED",CRIC:"CONTRACT_TENDER_ANALYZED",ACCO:"CONTRACT_TENDER_ANALYZED",CA:"CONTRACT_SEND_DOCUMENTS",CR:"CONTRACT_TENDER_REJECT",C:d,AP:"CONTRACT_DOCUMENTS_PENDING",AFP:"CONTRACT_DOCUMENTS_PENDING",CRIP:"CONTRACT_DOCUMENTS_PENDING",APA:"CONTRACT_DOCUMENTS_PENDING",APR:"CONTRACT_PAYMENT_ERROR",PL:"CONTRACT_PAYMENT_PENDING",PR:"CONTRACT_PAYMENT_SUCCESS",PE:"CONTRACT_PAYMENT_ERROR"}[a]]}function p(){t.modalConfig.open=!0,t.modalConfig.error.open=!0}function q(){t.loadingPage=!0,f.goToHome().then(function(b){a.go(b.routeHome,b)}).catch(function(){openModal("error")})}function r(){g(function(){m()},2e3)}function s(){}var t=this;i()}a.$inject=["$state","loanRoutes","commonRoutes","statusTenderService","loanStateManagement","userInfoService","$timeout","loanDataLayerFactory"],angular.module("internetBanking.loan").controller("StatusTenderController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(){s(),t(),u(),q.renewSession()}function s(){N.loadingPage=!0,N.watchEvent=!0,N.loadingSideBar=!1,N.closeAttempts=0,N.currentStep={step:1,loading:!0},f.clear(),N.model={form:f.getModel()},N.view={sidebar:{},openSideBar:!1},N.modal={open:!1,error:{open:!1},userRetention:{open:!1}},N.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0},{description:"Envie seus documentos",step:"2",selected:!1},{description:"Receba o seu dinheiro",step:"3",selected:!1}],N.contractSteps=[{description:"Sobre entrar em contato com você",step:1},{description:"Sobre você",step:2},{description:"Endereço residencial e correspondência",step:3},{description:"Sobre o seu trabalho",step:4},{description:"Seus dados bancários",step:5}],N.openModal=M}function t(){N.onClickDetailSideBar=J,N.onCloseErrorModal=E,N.onCloseRetentionModal=F,N.onCloseHeader=G,N.onCancelTender=I,N.onContinueContract=K,b.$on("$stateChangeStart",D)}function u(){x()}function v(){function a(a){f=a.data,c(f)}function b(a){0===Object.keys(f).length&&c()}function c(a){var b={},c=a||{};d.emprestimo&&"creditopravoce"===d.emprestimo&&(b=e.getSimulationData(),c.enderecoEletronico=b.user.email||a.enderecoEletronico,b.user.income&&(c.dadosClienteRendas=[{valor:b.user.income}])),Object.keys(f).length>0?N.dataUser=f:N.dataUser=c,N.model.form.one.name=c.nome||"",N.model.form.one.phoneMobile="",N.model.form.one.phoneMobile=c.dadosClienteTelefones.length>0?w(c.dadosClienteTelefones):"",N.mobilePhoneFinal=N.model.form.one.phoneMobile,Object.keys(N.dataUser.dadosClienteRendas).length>0&&(N.model.form.four.income=B(N.dataUser.dadosClienteRendas)),N.loadingPage=!1,A(c),C()}var d=p.getParams(),f=k.get();0===Object.keys(f).length?l.get().then(a).catch(b):c(f)}function w(a){var b=a.filter(function(a){return 9==a.numeroTelefone.length&&"9"===a.numeroTelefone.substr(0,1)});return b.length>0?b[0].numerenderecosDddTelefone+b[0].numeroTelefone:""}function x(){function a(a){c(a.data)}function b(){M("error")}function c(a){var b={},c=a,d=p.getParams();d.emprestimo&&"creditopravoce"===d.emprestimo&&(b=e.getSimulationData(),c.nomeCompleto=b.user.name||c.nomeCompleto,c.cep=b.user.cep||c.cep,c.dataNascimento=b.user.dateOfBirth||c.dataNascimento),N.dataClient=c,y(),v()}var d=j.get();0===Object.keys(d).length?m.get().then(a).catch(b):c(d)}function y(){var a=d.getDataSiderBar(),b=g.getDataSideBar(a);N.view.sidebar=b,g.setCacheSideBar(b)}function z(){var a=N.dataUser.dadosClienteEnderecos.filter(function(a){return"residencial"===a.tipoEndereco.toLowerCase()||"comercial"===a.tipoEndereco.toLowerCase()});return a.length>0?a:[]}function A(a){var b=z();h.set({mobile:"",email:"",dateOfBirth:a.dataNascimentoString||"",zipCode:b[0].cep||"",street:b[0].logradouro||"",cpf:d.getDataForm().cpfCnpj})}function B(a){var b=a.sort(function(a,b){return a.valor<b.valor})[0].valor;return Number(b).toFixed(2)}function C(){var a=(h.getDataWithMask("email"),h.getDataWithMask("mobile"),h.getDataWithMask("zipCode")),b=h.getDataWithMask("street"),c=N.model.form.three.form[0],d=p.getParams(),f={};d.emprestimo&&"creditopravoce"===d.emprestimo&&(f=e.getSimulationData(),N.model.form.four.timeWork=f.user.timeWork),a.length>0&&(c.cep=a,c.street=b,c.neighborhood=N.dataUser.dadosClienteEnderecos[0].bairro,c.city=N.dataUser.dadosClienteEnderecos[0].nomeCidade,c.state=N.dataUser.dadosClienteEnderecos[0].siglaUF,c.number=N.dataUser.dadosClienteEnderecos[0].numero?N.dataUser.dadosClienteEnderecos[0].numero:"")}function D(a,b){N.currentStep.step=parseInt(b.url[b.url.length-1]),N.currentStep.loading=!0}function E(){L("error"),H()}function F(){L("userRetention")}function G(){var a={},b={},c="";if(N.closeAttempts=N.closeAttempts+1,c=N.model.form.one.email&&N.model.form.one.email.indexOf("*")>-1?N.dataUser.enderecoEletronico||"":N.model.form.one.email,N.closeAttempts>1){N.loadingPage=!0;var e=z();a={valor:N.view.sidebar.valueSimulator,nome:N.model.form.one.name,cpf:d.getDataForm().cpfCnpj,email:c,zip:e.length>0?e[0].cep:"",logradouro:N.model.form.three.form[0].street.indexOf("*")>-1?N.dataUser.dadosClienteEnderecos[0].logradouro:N.model.form.three.form[0].street,cidade:e.length>0?e[0].cidadeNome:"",bairro:N.model.form.three.form[0].neighborhood,uf:e.length>0?e[0].cidadeUf:""},N.model.form.one.phoneResidential&&N.model.form.one.phoneResidential.length>0?a.txtPhone=N.model.form.one.phoneResidential:N.mobilePhoneFinal.length>0&&(a.txtPhone=N.mobilePhoneFinal),i.setUserData(a),b=i.getUserData(),document.leadParla&&document.leadParla.tender&&(document.leadParla.tender=!1,o.post(b).then(function(a){})),H()}else M("userRetention")}function H(){n.goToHome().then(function(b){a.go(b.routeHome,b)}).catch(function(){M("error")})}function I(){var b=document.showLoanSimulatorV2||!1,d=b?"SIMULATOR_V2":"SIMULATOR";a.go(c[d])}function J(){N.view.openSideBar=!N.view.openSideBar}function K(){L("userRetention")}function L(a){N.modal.open=!1,N.modal[a].open=!1}function M(a){N.modal.open=!0,N.modal[a].open=!0}var N=this;r()}a.$inject=["$state","$rootScope","loanRoutes","loanStateManagement","simulatorFactory","sendTenderAttributesFactory","contractParseDataFactory","maskToDataFormFactory","leadParlaFactory","dataClientFactory","dataUserFactory","cpDataUserMask","getDataClientService","userInfoService","leadParlaService","redirectPageService","inactivityService"],angular.module("internetBanking.loan").controller("ContractTenderController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){j(),k(),m(),n(),l()}function j(){s.phonePattern=g.PHONE,s.model=b.$parent.$parent.contract.model,s.modal={open:!1,confirm:{open:!1}}}function k(){s.onClickContinue=q,s.onClickConfirm=r,s.onClickCloseModal=p}function l(){var a=d.get("simulator").installmentSelected,b={seguro:!1,valorParcelas:a.quantidadeParcelas,numeroParcelas:a.numeroParcelas};f.setDataTenderStepOne(document.BVDatalayer,b),f.callCustomPageView(h.PAGE_NAME_CONTRACT_TENDER.DATA,h.PAGE_NAME_CONTRACT_TENDER.ROUTES.DATA)}function m(){s.dataClient=b.$parent.$parent.contract.dataClient,b.$parent.$parent.contract.currentStep.loading=!1}function n(){var a=e.getDataWithMask("email"),b=e.getDataWithMask("mobile");s.emailWithMask=a.length>0,s.mobileWithMask=b.length>0}function o(a){s.modal.open=!0,s.modal[a].open=!0}function p(){s.modal.open=!1,s.modal.confirm.open=!1}function q(){s.formOne.$setSubmitted(),s.formOne.$valid&&o("confirm")}function r(){a.go(c.CONTRACT_SEND_TENDER_STEP_TWO)}var s=this;i()}a.$inject=["$state","$scope","loanRoutes","loanStateManagement","maskToDataFormFactory","loanDataLayerFactory","formPatterns","loanConstant"],angular.module("internetBanking.loan").controller("ContractTenderStepOneController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){l(),m(),n(),o()}function l(){x.genderList=[{description:"Masculino",value:"M"},{description:"Feminino",value:"F"}],x.nationalityList=[{description:"Brasileiro(a)"},{description:"Estrangeiro(a)"}],x.model=b.$parent.$parent.contract.model,x.dataUfs=j}function m(){x.onClickContinue=v,x.onBackForm=w}function n(){p(),u()}function o(){h.setDataTenderStepTwo(document.BVDatalayer,x.model.form.one.phoneMobile.substring(0,2)),h.callCustomPageView(i.PAGE_NAME_CONTRACT_TENDER.ABOUT,i.PAGE_NAME_CONTRACT_TENDER.ROUTES.ABOUT)}function p(){x.dataClient=b.$parent.$parent.contract.dataClient,x.dataUser=b.$parent.$parent.contract.dataUser,q()}function q(){var a=e.getParams(),b={},c="",d="",g="";s(),t(),x.model.form.two.mother=x.dataUser.nomeMae||"",x.dataUser.dadosClienteDocumentos&&(g=x.dataUser.dadosClienteDocumentos.filter(function(a){return"CARTEIRA DE IDENTIDADE"===a.descricaoDocumento})[0])&&(x.model.form.two.rg=g.numeroDocumento||"",x.model.form.two.issuingOrganizer=g.orgaoEmissor||""),x.dataUser.nacionalidade&&("BRASILEIRO"===x.dataUser.nacionalidade?d="Brasileiro(a)":"ESTRANGEIRO"===x.dataUser.nacionalidade&&(d="Estrangeiro(a)"),d.length>0&&(x.model.form.two.nationality=d)),x.dataUser.sexo&&("Masculino"===x.dataUser.sexo?c="M":"Feminino"===x.dataUser.sexo&&(c="F"),x.model.form.two.gender=c),a.emprestimo&&"creditopravoce"===a.emprestimo&&(b=f.getSimulationData(),b.user.stateId&&(x.model.form.two.naturalness=j.filter(function(a){return a.codigoUf===parseInt(b.user.stateId)})[0]))}function r(a){return null!==a&&a.length>0}function s(){var a=g.getDataWithMask("cpf");x.maskCPF=!0,x.model.form.two.cpf=a}function t(){var a=r(x.dataUser.dataNascimentoString),b=g.getDataWithMask("dateOfBirth");x.dateOfBirthWithMask=r(b),x.model.form.two.dateOfBirth=b,x.dateOfBirthIsDisabled=a}function u(){function a(a){x.dataGender=a.data,b.$parent.$parent.contract.currentStep.loading=!1}function c(){b.$parent.$parent.contract.currentStep.loading=!1,b.$parent.$parent.contract.openModal("error")}d.get().then(a).catch(c)}function v(){x.formTwo.$setSubmitted(),x.formTwo.$valid&&a.go(c.CONTRACT_SEND_TENDER_STEP_THREE)}function w(){a.go(c.CONTRACT_SEND_TENDER_STEP_ONE)}var x=this;k()}a.$inject=["$state","$scope","loanRoutes","outherInformationGenderService","redirectPageService","simulatorFactory","maskToDataFormFactory","loanDataLayerFactory","loanConstant","dataUfs"],angular.module("internetBanking.loan").controller("ContractTenderStepTwoController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){k(),l(),m(),n()}function k(){v.model=b.$parent.$parent.contract.model,v.dataUfs=i}function l(){v.onChangeHasAddressAdditional=r,v.onClickContinue=p,v.onChangeInputZipCode=s,v.onBackForm=q}function m(){o();var a=f.getDataWithMask("zipCode");v.maskZipCode=a&&a.indexOf("*")>-1}function n(){g.callCustomPageView(h.PAGE_NAME_CONTRACT_TENDER.ADDRESS,h.PAGE_NAME_CONTRACT_TENDER.ROUTES.ADDRESS)}function o(){function a(a){v.dataTypeAddress=a.data,b.$parent.$parent.contract.currentStep.loading=!1}function c(){b.$parent.$parent.contract.openModal("error"),b.$parent.$parent.contract.currentStep.loading=!1}e.get().then(a).catch(c)}function p(){v.formThree.$setSubmitted(),v.formThree.$valid&&a.go(c.CONTRACT_SEND_TENDER_STEP_FOUR)}function q(){a.go(c.CONTRACT_SEND_TENDER_STEP_TWO)}function r(a){var b={},c={cep:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",statusStill:"",correspondence:!0};1===v.model.form.three.form.length&&a&&(b=_.isEmpty(w)?c:w,v.model.form.three.form.push(b),v.model.form.three.form[0].correspondence=!1),2!==v.model.form.three.form.length||a||(w=v.model.form.three.form[1],v.model.form.three.form.pop()),a||(v.model.form.three.form[0].correspondence=!0)}function s(a,b){return!!a&&t(a,b)}function t(a,b){var c={};d.get(a).then(function(a){c=a.data,u(c,b)}).catch(function(){u(c,b)})}function u(a,b){var c={logradouro:"",bairro:"",cidade:"",uf:""},d=Object.keys(a).length>0?a:c;"residencialAddress"===b&&(v.model.form.three.form[0].street=d.logradouro,v.model.form.three.form[0].neighborhood=d.bairro,v.model.form.three.form[0].city=d.cidade,v.model.form.three.form[0].state=d.uf),"additionalAddress"===b&&(v.model.form.three.form[1].street=d.logradouro,v.model.form.three.form[1].neighborhood=d.bairro,v.model.form.three.form[1].city=d.cidade,v.model.form.three.form[1].state=d.uf)}var v=this,w={};j()}a.$inject=["$state","$scope","loanRoutes","getAddressService","typeAddressService","maskToDataFormFactory","loanDataLayerFactory","loanConstant","dataUfs"],angular.module("internetBanking.loan").controller("ContractTenderStepThreeController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){k(),l(),m(),n()}function k(){x.formBenefit=!1,x.formEntrepreneur=!1,x.occupationList=[{description:"Assalariado",value:"1"},{description:"Empresario",value:"2"},{description:"Autônomo",value:"3"},{description:"Liberal",value:"4"},{description:"Outros",value:"5"},{description:"Funcionário Público",value:"6"},{description:"Aposentado ou Pensionista",value:"7"}],x.model=b.$parent.$parent.contract.model,x.dataUfs=i}function l(){x.onClickContinue=r,x.onChangeSelectOccupation=t,x.onChangeInputZipCode=u,x.onBackForm=s}function m(){q(),o()}function n(){var a={cidade:x.model.form.three.form[0].city,estado:x.model.form.three.form[0].state};g.setDataTenderStepFour(document.BVDatalayer,a),g.callCustomPageView(h.PAGE_NAME_CONTRACT_TENDER.WORK,h.PAGE_NAME_CONTRACT_TENDER.ROUTES.WORK)}function o(){x.dataClient=b.$parent.$parent.contract.dataClient}function p(){var a={};x.dataUser=b.$parent.$parent.contract.dataUser,x.dataUser.profissao&&(a=x.dataProfessional.filter(function(a){return a.descricaoProfissao===x.dataUser.profissao.toUpperCase()}),0===x.model.form.four.profession.length&&x.dataUser.profissao&&a.length>0&&(x.model.form.four.profession=a[0].codigoProfissao))}function q(){function a(a){x.dataProfessional=a.data,b.$parent.$parent.contract.currentStep.loading=!1,p()}function c(){b.$parent.$parent.contract.openModal("error"),b.$parent.$parent.contract.currentStep.loading=!1}e.get().then(a).catch(c)}function r(){d.get("simulator").installmentSelected.valorParcela;x.formFour.$setSubmitted(),x.formFour.$valid&&a.go(c.CONTRACT_SEND_TENDER_STEP_FIVE)}function s(){a.go(c.CONTRACT_SEND_TENDER_STEP_THREE)}function t(a){x.formBenefit=!1,x.formEntrepreneur=!1,7===parseInt(a,10)?x.formBenefit=!0:2===parseInt(a,10)&&(x.formEntrepreneur=!0)}function u(a){return!!a&&v(a)}function v(a){var b={};f.get(a).then(function(a){b=a.data,w(b)}).catch(function(){w(b)})}function w(a){var b={logradouro:"",bairro:"",cidade:"",uf:""},c=Object.keys(a).length>0?a:b;x.model.form.four.address.street=c.logradouro,x.model.form.four.address.neighborhood=c.bairro,x.model.form.four.address.city=c.cidade}var x=this;j()}a.$inject=["$state","$scope","loanRoutes","loanStateManagement","professionalInformationProfessionService","getAddressService","loanDataLayerFactory","loanConstant","dataUfs"],angular.module("internetBanking.loan").controller("ContractTenderStepFourController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(){s(),v(),y(),A(),B()}function s(){N.encrypt=null,N.onlybillet=!1,N.paymentTypeIsDisabled=!1,N.showHideDatasAccount=!1,N.paymentTypes=[{description:"Carnê",value:"3"},{description:"Débito em conta",value:"4"}],N.model=b.$parent.$parent.contract.model,N.model.form.five.favored=N.model.form.one.name,u(),t(),"PE"===N.model.form.three.form[0].state?(N.model.form.five.paymentType="3",N.paymentTypeIsDisabled=!0,N.onlybillet=!0):N.onlybillet=!1,N.maskAccount="99999999999"}function t(){N.agencyDisabled=!1,"CONTA_PAGAMENTO"===N.model.form.five.typeAccount&&(N.agencyDisabled=!0)}function u(){var a=i.getDataWithMask("cpf");N.maskCPF=!0,N.model.form.five.cpf=a}function v(){N.onClickContinue=D,N.onChangeSelectBank=L,N.onBackForm=E,N.onChangeTypeAccount=J,N.onChangeSelectPaymentType=w}function w(a){N.banks=4==+a?x(N.allBanks):[].concat(N.allBanks),N.model.form.five.bank=""}function x(a){const b=[].concat(O);return a.filter(function(a){return b.includes(a.codigoBacen)})}function y(){C(),z()}function z(){function a(a){N.encrypt.setPublicKey(a.data.key)}function b(){}var c=k.getHeaders();N.encrypt=new JSEncrypt,c&&""!==c.TokenCS?p.getPublicKey().then(a).catch(b):o.getPublicKey().then(a).catch(b)}function A(){var a={prof:N.model.form.four.profession,rInf:N.model.form.four.income};j.setDataTenderStepFive(document.BVDatalayer,a),j.callCustomPageView(n.PAGE_NAME_CONTRACT_TENDER.PAYMENT,n.PAGE_NAME_CONTRACT_TENDER.ROUTES.PAYMENT)}function B(){N.model.form.five.typeAccount=N.model.form.five.typeAccount?N.model.form.five.typeAccount:"CONTA_CORRENTE"}function C(){function a(a){N.banks=[].concat(a.data),N.allBanks=[].concat(a.data);for(var c=a.data,d=h.firstingBanks(),e=0;e<d.length;e++){var f=c.find(function(a){return a.codigoBacen===d[e].codigoBacen});f&&(c.splice(c.findIndex(function(a){return a.codigoBacen===f.codigoBacen}),1),c.unshift(f))}h.setBankList(N.banks),b.$parent.$parent.contract.currentStep.loading=!1}function c(){b.$parent.$parent.contract.openModal("error"),b.$parent.$parent.contract.currentStep.loading=!1}g.get().then(a).catch(c)}function D(){N.formFive.$setSubmitted(),N.formFive.$valid&&(F("button-form-five-spinner"),G())}function E(){a.go(d.CONTRACT_SEND_TENDER_STEP_FOUR)}function F(a){c.$emit(m.SPINNING_START,{target:a})}function G(){var a={},b={},c=i.removeMask(N.model),d=k.getHeaders();q.reset(),q.create(c),N.formEntrepreneur&&q.addEntrepreneur(c),a=q.get(),b=d&&""!==d.TokenCS?p.createPayload(a,N.encrypt):o.createPayload(a,N.encrypt),H(b)}function H(a){function c(a){I(a.data)}function d(a){b.$parent.$parent.contract.openModal("error")}var f=k.getHeaders();f&&null!==f.TokenCS?e.createOpenShift2(a).then(c).catch(d):e.create(a).then(c).catch(d)}function I(b){var b={idProposta:b.nuProposta,banco:N.model.form.five.bank,tipoPag:N.model.form.five.paymentType};j.setDataTenderSend(document.BVDatalayer,b),j.callCustomPageView(n.PAGE_NAME_CONTRACT_TENDER.SEND),f.set("tender",b),f.set("hasCache",!0),a.go(d.CONTRACT_TENDER_PROCESS)}function J(){K(!1),"CONTA_PAGAMENTO"===N.model.form.five.typeAccount&&(N.model.form.five.officeBank=h.getAgencyNumber(),N.agencyDisabled=!0),"CONTA_CORRENTE"===N.model.form.five.typeAccount&&(N.agencyDisabled=!1),N.showHideDatasAccount=!0}function K(a){N.model.form.five.bank=a?N.model.form.five.bank:"",N.model.form.five.officeBank="CONTA_PAGAMENTO"===N.model.form.five.typeAccount?h.getAgencyNumber():"",N.model.form.five.checkingAccount="",N.model.form.five.digit=""}function L(a){K(!0);var b=h.getBankName(a);if(N.maskAccount=h.getMaskBank(a),N.model.form.five.paymentType="",N.paymentTypeIsDisabled=!1,!N.onlybillet&&M(a))return N.model.form.five.paymentType="4",N.paymentTypeIsDisabled=!0,!1;l.setBankName(b),N.paymentTypeIsDisabled=!0,N.model.form.five.paymentType="3"}function M(a){return 0!==[].concat(O).filter(function(b){return a===b}).length}var N=this,O=["033","237","341","001"];r()}a.$inject=["$state","$scope","$rootScope","loanRoutes","tenderService","loanStateManagement","bankService","bankFactory","maskToDataFormFactory","loanDataLayerFactory","tokenCSFactory","leadParlaFactory","commonEvents","loanConstant","rsaPublicKeyService","rsaOpenshiftPublicKeyService","sendTenderPayloadFactory"],angular.module("internetBanking.loan").controller("ContractTenderStepFiveController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(){j.callCustomPageView(g.PAGE_NAME_CONTRACT_DOCUMENT.UPLOAD),s(),t(),v(),q.renewSession()}function s(){Q.listImages=null,Q.dataSidebar=null,Q.showCheckListError=!1,Q.paramCheckList={},Q.loanRoutes=f,Q.commonRoutes=e,Q.view=l.createView(),Q.model=l.createModel(),Q.stateUI=l.createStateUI(),Q.modalConfig=l.createModalConfig(),Q.countAttempts=l.createCountAttempts(),Q.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!0},{description:"Receba o seu dinheiro",step:"3",selected:!1}]}function t(){Q.onClickDetailSideBar=O,Q.upload=A,Q.onClickEditUpload=N,Q.onClickSendCETCCB=H,Q.onDisabledSubscribeDocument=J,Q.onClickCloseModal=L,Q.onCloseHeader=K}function u(a){Q.view.sidebar=a,Q.loadingSideBar=!1}function v(){function a(a){w(a.data)}function b(){if(Q.countAttempts.tender<2)return Q.countAttempts.tender++,void P(v);M("error")}n.get().then(a).catch(b)}function w(a){h.set("tender",a),h.set("hasCache",!0),h.setParseTender(a);var b=x(a),c=k.getDataSideBar(b);k.setCacheSideBar(c),u(c),Q.paramCheckList={numberTender:a.numeroProposta,operator:a.operador,codeProduct:a.cdproduto,institution:a.instituicao},y(Q.paramCheckList)}function x(a){return{valueTender:a.valorProposta,dateFirstInstallment:a.dataVencimentoPrimeiraParcela.replace(/-/g,"/"),amountInstallment:a.quantidadeParcelas,valueInstalment:a.valorParcela,total:a.valorFinanciamento,dateSimulator:moment(a.dataEntrada,"DD-MM-YYYY").format("DD/MM/YYYY"),interestRate:{month:a.valorTaxaPactuada,year:a.taxaPactuadaAnual},cet:{month:a.taxaCet,year:a.taxaCetAnual}}}function y(b){function c(b){var c=b.data.filter(function(a){return"CCB e CET"===a.dsDocumento})[0];c&&"Não analisado"===c.dsStatusRecebimento&&a.go(f.CONTRACT_DOCUMENTS_PENDING),z(b.data)}function d(){if(Q.countAttempts.checklist<2)return Q.countAttempts.checklist++,void P(y,Q.paramCheckList);Q.showCheckListError=!0,z([{dsDocumento:"CCB e CET",cdTpdoc:481,dsStatusRecebimento:"Não digitalizado"},{dsDocumento:"RG e CPF ou CNH",cdTpdoc:506,dsStatusRecebimento:"Não digitalizado"}])}p.get(b).then(c).catch(d)}function z(a){var b=!1,c=-1,d=a.filter(function(a){return"CCB e CET"!==a.dsDocumento});Q.listImages=d;for(var e=0;e<d.length;e++)"Reprovado"===Q.listImages[e].dsStatusRecebimento?(b=!0,Q.view.bypassCETCCB=!0,c=e,Q.stateUI.upload[e].classError=!0,Q.stateUI.upload[e].reprovado=!0,Q.stateUI.upload[e].status=!1,Q.stateUI.upload[e].completed=!0,Q.stateUI.upload[e].edit=!0,Q.stateUI.upload[e].showButton=!1):"Não digitalizado"!==Q.listImages[e].dsStatusRecebimento&&(Q.stateUI.upload[e].classError=!1,Q.stateUI.upload[e].status=!0,Q.stateUI.upload[e].completed=!0,Q.stateUI.upload[e].edit=!0,Q.stateUI.upload[e].showButton=!1);b&&(Q.view.uploadError.name=h.get("tender").proponente.nome,Q.view.uploadError.reason=Q.listImages[c].motivoDevolucao,Q.view.uploadError.reason=Q.view.uploadError.reason.replace(/_/g," "),Q.view.uploadError.reason=Q.view.uploadError.reason.toLowerCase()),Q.loadingPage=!1}function A(a,b){if(B(b),C(a))return void D(a,b);E(b)}function B(a){Q.stateUI.upload[a].status=!1,Q.stateUI.upload[a].edit=!1,Q.stateUI.upload[a].completed=!1,Q.stateUI.upload[a].loading=!1,Q.stateUI.upload[a].active=!1,Q.stateUI.upload[a].reprovado=!1}function C(a){return a&&a.length>0}function D(a,b){function c(){G(b)}function d(){B(b),Q.stateUI.upload[b].showButton=!0,Q.stateUI.upload[b].classError=!1}function e(a){F(b,a)}Q.stateUI.upload[b].showButton=!1,Q.stateUI.upload[b].showProgress=!0,Q.stateUI.upload[b].loading=!0,Q.stateUI.upload[b].completed=!1,Q.stateUI.upload[b].active=!0,i.upload({url:R,data:{nomeDocumento:a[0],cdTpdoc:Q.listImages[b].cdTpdoc,identificacao:"1",cdProduto:h.get("tender").cdproduto,nrProp:h.get("tender").numeroProposta,entCdOpera:h.get("tender").operador,entNumInst:h.get("tender").instituicao}}).then(c,d,e)}function E(a){var b=[Q.view.formUploadOne,Q.view.formUploadTwo];b[a].$invalid&&b[a].$error&&b[a].$error.maxSize?M("uploadSize"):b[a].$invalid&&b[a].$error&&b[a].$error.pattern&&M("uploadPattern")}function F(a,b){var c=parseInt(100*b.loaded/b.total);Q.stateUI.upload[a].showProgress=!0,Q.stateUI.upload[a].progressValue=c-100,Q.stateUI.upload[a].showButton=!1}function G(a){Q.stateUI.upload[a].showProgress=!1,Q.stateUI.upload[a].completed=!0,Q.stateUI.upload[a].edit=!0,Q.stateUI.upload[a].status=!0,Q.stateUI.upload[a].showButton=!1,Q.stateUI.upload[a].loading=!1,Q.stateUI.upload[a].classError=!1,Q.stateUI.upload[a].reprovado=!1}function H(){if(Q.view.bypassCETCCB)return I(),!1;a.go(f.CONTRACT_CCB)}function I(){m.set({successRoute:f.CONTRACT_DOCUMENTS_PENDING,prefixEndpoint:c.LOAN_CONTRACT_SEND_TOKEN,codigoParceiroComercial:parseInt(h.get("tender").parceiroComercial.codigo),numeroPropostaParceria:h.get("tender").numeroProposta}),m.sendDataToken(),a.go(f.CONTRACT_AUTHENTICATION_TOKEN)}function J(){return!0!==Q.stateUI.upload[0].status}function K(){Q.loadingPage=!0,o.goToHome().then(function(b){a.go(b.routeHome,b)}).catch(function(){M("error")})}function L(a){Q.modalConfig.open=!1,Q.modalConfig[a].open=!1}function M(a){Q.modalConfig.open=!0,Q.modalConfig[a].open=!0}function N(a){Q.stateUI.upload[a].showButton=!0,Q.stateUI.upload[a].edit=!1}function O(){Q.view.openSideBar=!Q.view.openSideBar}function P(a,c){b(function(){c?a(c):a()},3e3)}var Q=this,R=d.backEnd+c.LOAN_CONTRACT_UPLOAD;Q.loadingPage=!0,Q.watchEvent=!0,Q.loadingSideBar=!0,r()}a.$inject=["$state","$timeout","endPoints","appSettings","commonRoutes","loanRoutes","loanConstant","loanStateManagement","Upload","loanDataLayerFactory","contractParseDataFactory","uploadOfDocumentsAttributesFactory","authenticationTokenLoanFactory","tenderService","userInfoService","checkListDocumentsService","inactivityService"],angular.module("internetBanking.loan").controller("ContractSendDocumentsController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){h.callCustomPageView(f.PAGE_NAME_CONTRACT_DOCUMENT.UPLOAD),r(),s(),u(),o.renewSession()}function r(){U.listImages=null,U.dataSidebar=null,U.showCheckListError=!1,U.paramCheckList={},U.loanRoutes=e,U.commonRoutes=d,U.view=j.createView(),U.model=j.createModel(),U.stateUI=j.createStateUI(),U.modalConfig=j.createModalConfig(),U.countAttempts=j.createCountAttempts(),U.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!0},{description:"Receba o seu dinheiro",step:"3",selected:!1}]}function s(){U.onClickDetailSideBar=S,U.upload=C,U.onClickEditUpload=R,U.onClickSendCETCCB=L,U.onDisabledSubscribeDocument=N,U.onClickCloseModal=P,U.onCloseHeader=O,U.showUploadedDocument=x}function t(a){U.view.sidebar=a,U.loadingSideBar=!1}function u(){function a(a){v(a.data)}function b(){if(U.countAttempts.tender<2)return U.countAttempts.tender++,void T(u);Q("error")}
l.get().then(a).catch(b)}function v(a){g.set("tender",a),g.set("hasCache",!0),g.setParseTender(a);var b=w(a),c=i.getDataSideBar(b);i.setCacheSideBar(c),t(c),U.paramCheckList={numeroProposta:a.numeroProposta},A(U.paramCheckList)}function w(a){return{valueTender:a.valorProposta,dateFirstInstallment:a.dataVencimentoPrimeiraParcela.replace(/-/g,"/"),amountInstallment:a.quantidadeParcelas,valueInstalment:a.valorParcela,total:a.valorFinanciamento,dateSimulator:moment(a.dataEntrada,"DD-MM-YYYY").format("DD/MM/YYYY"),interestRate:{month:a.valorTaxaPactuada,year:a.taxaPactuadaAnual},cet:{month:a.taxaCet,year:a.taxaCetAnual}}}function x(a){var b=U.listImages.filter(function(b){return b.descricaoFileNet==a});b.length>0&&n.getUploadedDocuments(b[0].idFileNet).then(function(a){y(a)}).catch(function(a){console.log(a)})}function y(a){for(var b=a.documento,c=a.contentType,d=atob(b),e=[],f=0;f<d.length;f+=512){for(var g=d.slice(f,f+512),h=new Array(g.length),i=0;i<g.length;i++)h[i]=g.charCodeAt(i);var j=new Uint8Array(h);e.push(j)}var k=new Blob(e,{type:c}),l=URL.createObjectURL(k);window.open(l)}function z(){function a(a){a.listaDocumento.forEach(function(a){U.listImages.forEach(function(b){b.codigoDocumento==a.codigoDocumento&&""!=a.idFileNet&&(b.idDocumento=a.idDocumento,b.motivoRecusa=a.motivoRecusa,b.idFileNet=a.idFileNet,b.dataInclusao=a.dataInclusao,b.dataAlteracao=a.dataAlteracao,b.statusDocumento=a.statusDocumento,b.descricaoStatus=a.descricaoStatus)})}),null==a.observacaoAnalista?U.view.uploadError.reason="":U.view.uploadError.reason=a.observacaoAnalista,B(U.listImages)}function b(){if(U.countAttempts.checklist<2)return U.countAttempts.checklist++,void T(z);U.showCheckListError=!0}var c={numeroProposta:g.get("tender").numeroProposta.toString(),codigoParceiro:g.get("tender").parceiroComercial.codigo};n.getDocumentList(c).then(a).catch(b)}function A(b){function c(b){var c=b.listaDocumento.filter(function(a){return 147===a.codigoDocumento})[0];c&&3==c.statusDocumento&&a.go(e.CONTRACT_DOCUMENTS_PENDING),B(b.listaDocumento),z()}function d(){if(U.countAttempts.checklist<2)return U.countAttempts.checklist++,void T(A,U.paramCheckList);U.showCheckListError=!0,B([{codigoDocumento:147,nomeDocumento:"CCB e CET",indicadorObrigatoriedade:"S",indicadorAtivo:"S",statusDocumento:1,descricaoStatus:"Aguardando Envio",descricaoFileNet:"PFccb",indicadorDocumentoBaixado:"S",Cdpapeldocumento:147},{codigoDocumento:149,nomeDocumento:"RG e CPF",indicadorObrigatoriedade:"S",indicadorAtivo:"S",statusDocumento:1,descricaoStatus:"Aguardando Envio",descricaoFileNet:"PFDocumentoIdentificacao",indicadorDocumentoBaixado:"S",Cdpapeldocumento:149},{codigoDocumento:161,nomeDocumento:"MINUTARIA",indicadorObrigatoriedade:"S",indicadorAtivo:"S",statusDocumento:1,descricaoStatus:"Aguardando Envio",descricaoFileNet:"Pfcet",indicadorDocumentoBaixado:"S",Cdpapeldocumento:161}])}n.getCheckList(b).then(c).catch(d)}function B(a){var b=!1,c=a.filter(function(a){return 149==a.codigoDocumento||4==a.codigoDocumento});U.listImages=c;for(var d=0;d<c.length;d++)5==U.listImages[d].statusDocumento?(b=!0,U.view.bypassCETCCB=!0,d,U.stateUI.upload[d].classError=!0,U.stateUI.upload[d].reprovado=!0,U.stateUI.upload[d].status=!1,U.stateUI.upload[d].completed=!0,U.stateUI.upload[d].edit=!0,U.stateUI.upload[d].showButton=!1):1!==U.listImages[d].statusDocumento&&(U.stateUI.upload[d].classError=!1,U.stateUI.upload[d].status=!0,U.stateUI.upload[d].completed=!0,U.stateUI.upload[d].edit=!0,U.stateUI.upload[d].showButton=!1);b&&(U.view.uploadError.name=g.get("tender").proponente.nome,null==U.view.uploadError.reason?U.view.uploadError.reason="":(U.view.uploadError.reason=U.view.uploadError.reason.replace(/_/g," "),U.view.uploadError.reason=U.view.uploadError.reason.toLowerCase())),U.loadingPage=!1}function C(a,b){if(D(b),E(a))return void J(a,b);G(b)}function D(a){U.stateUI.upload[a].status=!1,U.stateUI.upload[a].edit=!1,U.stateUI.upload[a].completed=!1,U.stateUI.upload[a].loading=!1,U.stateUI.upload[a].active=!1,U.stateUI.upload[a].reprovado=!1}function E(a){return a&&a.length>0}function F(a,b,c){function d(){K(c)}function e(){D(c),U.stateUI.upload[c].showButton=!0,U.stateUI.upload[c].classError=!1}function f(a){H(c,a)}U.stateUI.upload[c].showButton=!1,U.stateUI.upload[c].showProgress=!0,U.stateUI.upload[c].loading=!0,U.stateUI.upload[c].completed=!1,U.stateUI.upload[c].active=!0,p.getUserCPF().then(function(h){console.log(b);var i={documento:I(a),nuCpfCnpj:h.name,contentType:b[0].type,nome:b[0].name.toUpperCase(),tipoDocumento:U.listImages[c].descricaoFileNet,numeroProposta:g.get("tender").numeroProposta.toString(),codigoParceiro:g.get("tender").parceiroComercial.codigo,codigoDocumento:U.listImages[c].codigoDocumento,indicadorObrigatoriedade:!0};console.log(i),n.uploadDocument(i).then(d,e,f)})}function G(a){var b=[U.view.formUploadOne,U.view.formUploadTwo];b[a].$invalid&&b[a].$error&&b[a].$error.maxSize?Q("uploadSize"):b[a].$invalid&&b[a].$error&&b[a].$error.pattern&&Q("uploadPattern")}function H(a,b){var c=parseInt(100*b.loaded/b.total);U.stateUI.upload[a].showProgress=!0,U.stateUI.upload[a].progressValue=c-100,U.stateUI.upload[a].showButton=!1}function I(a){var b=a.result.indexOf("base64,");return a.result.substring(b+7)}function J(a,b){var c=new FileReader;c.onloadend=function(){F(c,a,b)},c.readAsDataURL(a[0])}function K(a){U.stateUI.upload[a].showProgress=!1,U.stateUI.upload[a].completed=!0,U.stateUI.upload[a].edit=!0,U.stateUI.upload[a].status=!0,U.stateUI.upload[a].showButton=!1,U.stateUI.upload[a].loading=!1,U.stateUI.upload[a].classError=!1,U.stateUI.upload[a].reprovado=!1,A(U.paramCheckList)}function L(){if(U.view.bypassCETCCB)return M(),!1;a.go(e.CONTRACT_CCB)}function M(){k.set({successRoute:e.CONTRACT_DOCUMENTS_PENDING,prefixEndpoint:c.LOAN_CONTRACT_SEND_TOKEN,codigoParceiroComercial:parseInt(g.get("tender").parceiroComercial.codigo),numeroPropostaParceria:g.get("tender").numeroProposta}),k.sendDataToken(),a.go(e.CONTRACT_AUTHENTICATION_TOKEN)}function N(){return!0!==U.stateUI.upload[0].status}function O(){U.loadingPage=!0,m.goToHome().then(function(b){a.go(b.routeHome,b)}).catch(function(){Q("error")})}function P(a){U.modalConfig.open=!1,U.modalConfig[a].open=!1}function Q(a){U.modalConfig.open=!0,U.modalConfig[a].open=!0}function R(a){U.stateUI.upload[a].showButton=!0,U.stateUI.upload[a].edit=!1}function S(){U.view.openSideBar=!U.view.openSideBar}function T(a,c){b(function(){c?a(c):a()},3e3)}var U=this;U.loadingPage=!0,U.watchEvent=!0,U.loadingSideBar=!0,q()}a.$inject=["$state","$timeout","endPoints","commonRoutes","loanRoutes","loanConstant","loanStateManagement","loanDataLayerFactory","contractParseDataFactory","uploadOfDocumentsAttributesFactory","authenticationTokenLoanFactory","tenderService","userInfoService","uploadDocumentsServiceV2","inactivityService","userService"],angular.module("internetBanking.loan").controller("ContractSendDocumentsControllerV2",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){l.callCustomPageView(m.PAGE_NAME_CONTRACT_DOCUMENT.CCB),o(),p(),q()}function o(){v.view={cet:{},ccb:{},valueTender:"",valueInstallment:""},v.modalConfig={open:!1,error:{open:!1}},v.model={cet:!1},v.readUseTerms=!1,v.commonRoutes=c,v.loanRoutes=b,v.loanTemplateUrls=d,v.loadingPage=!0,v.watchEvent=!0,v.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!0},{description:"Receba o seu dinheiro",step:"3",selected:!1}]}function p(){v.onClickSubscribeDocument=s,v.onBackDocuments=t}function q(){function a(a){v.loadingPage=!1,r(a.data)}function b(a){u()}e.getCETCCB().then(a).catch(b)}function r(a){v.view.orcamento=a.orcamento,v.view.cet=f.convertCETAPItoFront(a),v.view.ccb=f.convertCCBAPItoFront(a),v.view.ccb.date=moment().format("LL"),v.view.valueInstallment=j.formatMoney(i.get("tender").valorParcela),v.view.valueTender=j.formatMoney(i.get("tender").valorProposta)}function s(){var c={successRoute:b.CONTRACT_DOCUMENTS_PENDING,prefixEndpoint:h.SEND_TOKEN,kindTokenTransaction:"CONFIRMAR_CONTRATACAO_CREDITO_PESSOAL",pageName:"bv|area-logada|credito|credito-pessoal|documentos|token",dataTransaction:{dadosAceiteDigital:{numeroPropostaParceria:i.get("tender").numeroProposta,codigoParceiroComercial:parseInt(i.get("tender").parceiroComercial.codigo),logAceiteDigital:{dataOcorrencia:j.formatDate(moment().format("L"))._i,sistemaOperacional:k.os+" | "+k.os_version,navegadorInternet:k.browser}}}};g.setDataTransaction(c),a.go(b.CONTRACT_AUTHENTICATION_TOKEN)}function t(){a.go(b.CONTRACT_SEND_DOCUMENTS)}function u(){v.modalConfig.open=!0,v.modalConfig.error.open=!0}var v=this;n()}a.$inject=["$state","loanRoutes","commonRoutes","loanTemplateUrls","CETCCBService","CETCCBFactory","authTokenFactory","loanEndPoints","loanStateManagement","loanUtilsFactory","deviceDetector","loanDataLayerFactory","loanConstant"],angular.module("internetBanking.loan").controller("ContractCCBController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){var a={},b={};F(),l.get().then(function(c){a=t(c.data),b=j.getDataSideBar(a),K=c.data,G.loadingPage=!1}).catch(function(a){G.loadingPage=!1}),null===k.get("hasCache")?(j.setCacheSideBar(b),G.view.sidebar=b,G.loadingSideBar=!1):(G.view.sidebar=j.getCacheSideBar(),G.loadingSideBar=!1),G.loadingSideBar=!1;var d=c.getDataTransaction(),g=d.receiveType||"DEFAULT",h=d.pageName;G.receiveType=g,G.model.receive="DEFAULT"===g?"SMS":g,e.customPageView({pageName:H(h)}),f.$broadcast("scrollTop")}function t(a){return{valueTender:m.formatMoney(a.valorProposta),dateFirstInstallment:a.dataVencimentoPrimeiraParcela.replace(/-/g,"/"),amountInstallment:a.quantidadeParcelas,valueInstalment:m.formatNumberMoney(a.valorParcela),total:m.formatNumberMoney(a.valorFinanciamento),dateSimulator:moment(a.dataEntrada,"DD-MM-YYYY").format("DD/MM/YYYY"),interestRate:{month:a.valorTaxaPactuada,year:a.taxaPactuadaAnual},cet:{month:a.taxaCet,year:a.taxaCetAnual}}}function u(){G.view.openSideBar=!G.view.openSideBar}function v(){var a=c.getDataTransaction();J={data:{contatoCliente:Object.keys(K).length>0?{dsEnderecoEletronico:K.proponente.contato.email,nuTelefoneCelular:K.proponente.contato.numeroCelular,cdDDD:K.proponente.contato.dddCelular}:{},dadosAceiteDigital:a.dataTransaction,tipoDeEnvio:G.model.receive,tipoTransacaoToken:a.kindTokenTransaction},prefixEndpoint:a.prefixEndpoint,successRoute:a.successRoute};for(var b in a.dataTransaction)J.data[b]=a.dataTransaction[b];return J}function w(b){var c=6,d=a.open(g,[c,c],null,b);return G.view.disabledToken=!0,G.model.token="",d.then(function(a){G.model.token=a,G.view.disabledToken=!1,G.view.disabledConfirm=!1},function(a){G.view.disabledToken=!1}),d}function x(){function a(a){G.resend=!0,n(function(){G.view.disabledBtnSendToken=f.countTokenAttempts>4,G.view.labelBtnSendToken=L.resend},I),G.view.modalMessage=y(a.data.destinoDeEnvio),G.view.modalConfig.open=!0,G.view.disabledToken=!1}function c(a){G.view.modalMessage=angular.equals(a.status,422)?a.data.messages[1]:L.sendTokenError,G.view.modalErrorConfig.open=!0,G.view.disabledBtnSendToken=!1}A("send-token-spinner"),G.view.disabledBtnSendToken=!0;var d,e=v();if(G.resend){e.prefixEndpoint="/api/propostacp/aceite-digital/token/financiamento/reenviar/v1"}r.createPayload(e,G.encrypt);return d=G.resend?b.resend(e):b.send(e),d.then(a).catch(c).finally(function(){B("send-token-spinner",!1)}),d}function y(a){return("EMAIL"===G.model.receive?"Código enviado via E-mail para ":"Código enviado via SMS para o número ")+a}function z(){function a(a){f.countTokenAttempts=0,p.callCustomPageView(q.PAGE_NAME_CONTRACT_DOCUMENT.SEND),h.go(d.successRoute)}function c(a){var b=a&&a.data&&a.data.messages&&a.data.messages[1],c="";"SMS"===G.receiveType&&(f.countTokenAttempts+=1),c=f.countTokenAttempts>4?L.confirmTokenError:L.confirmTokenWarning,G.view.modalErrorConfig.open=!0,G.view.disabledConfirm=!0,G.view.disabledToken=!0,G.model.token="",G.view.disabledBtnSendToken=f.countTokenAttempts>4,G.view.modalMessage=f.countTokenAttempts<4?b:c,G.resend=!1}A("confirm-token-spinner");var d=v();d.token=G.model.token;var e=(r.createPayload(d,G.encrypt),b.confirmOperationCP(d));return e.then(a).catch(c).finally(function(){B("confirm-token-spinner",!0)}),e}function A(a){f.$emit(d.SPINNING_START,{target:a})}function B(a,b){f.$emit(d.SPINNING_STOP,{target:a,disabledBtn:b})}function C(){G.view.modalConfig.open=!1}function D(){G.view.modalErrorConfig.open=!1}function E(){h.go(o.CONTRACT_CCB)}function F(){function a(a){G.encrypt.setPublicKey(a.data.key)}function b(){}G.encrypt=new JSEncrypt,r.getPublicKey().then(a).catch(b)}var G=this,H=i("translate"),I=1e4,J={},K={},L={sendNow:H("@SITE-CARTAO-CREDITO-LINK-SEGURANCA-ENVIAR-AGORA"),resend:H("@SITE-CARTAO-CREDITO-LINK-SEGURANCA-REENVIAR-AGORA"),sendTokenError:H("@SITE-CARTAO-CREDITO-SEGURANCA-AUTENTICACAO_TOKEN-ENVIAR-MODAL-ERRO"),confirmTokenWarning:H("@SITE-CARTAO-CREDITO-SEGURANCA-AUTENTICACAO_TOKEN-CONFIRMAR-MODAL-AVISO"),confirmTokenError:H("@SITE-CARTAO-CREDITO-SEGURANCA-AUTENTICACAO_TOKEN-CONFIRMAR-MODAL-ERRO")};G.encrypt=null,G.resend=!1,G.view={disabledToken:!0,disabledConfirm:!0,disabledBtnSendToken:f.countTokenAttempts>4,modalConfig:{open:!1},modalErrorConfig:{open:!1},labelBtnSendToken:L.sendNow,noIconSidebar:!1,sidebar:{},openSideBar:!1},G.model={receive:""},G.receiveType="",G.loadingPage=!0,G.watchEvent=!0,G.onFocusTokenValue=w,G.onConfirmSendToken=x,G.onConfirmToken=z,G.onClickDetailSideBar=u,G.onCloseModalToken=C,G.onCloseModalTokenError=D,G.onBackCCD=E,G.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!0},{description:"Receba o seu dinheiro",step:"3",selected:!1}],s()}a.$inject=["VirtualKeyboard","contractAuthTokenService","authTokenFactory","commonEvents","dataLayerFactory","$rootScope","$scope","$state","$filter","contractParseDataFactory","loanStateManagement","tenderService","loanUtilsFactory","$timeout","loanRoutes","loanDataLayerFactory","loanConstant","rsaPublicKeyService"],angular.module("internetBanking.loan").controller("ContractAuthTokenController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G){function H(){J(),K(),N(),O(),Ba(),Fa(),I()}function I(){F.clear()}function J(){Ha.loanRoutes=v,Ha.checkBoxInstallments="sugestoes",Ha.view={step:{one:!0,two:!1},formSimulator:{},formModal:{},disabledInput:!1,recalculateInstallments:!1,formatMoney:n.formatMoney,lineSelected:[!1,!1,!1,!1,!1],listSuggestions:[],listOthers:[],hasOptions:!1,sideBar:{name:"",valueMaxSimulator:""}},Ha.model={moneySimulator:"",dateSimulator:moment().format("L"),declaration:!1,userPhoneNumber:""},Ha.modalConfig={open:!1,datepicker:{open:!1,modifierClass:"-datepicker"},error:{open:!1},noPreApproved:{open:!1},modalInfoSCR:{open:!1}},Ha.installmentSelected={clicked:!1,installment:{}},Ha.disableInvalidDates=Aa,Ha.valueMaxSimulator=0,Ha.valueMinSimulator=520,Ha.user=c.getUserCached(),Ha.model.userPhoneNumber=Ha.user&&Ha.user.phone?Ha.user.phone:c.phone,Ha.model.userEmail=Ha.user&&Ha.user.email?Ha.user.email:c.email,Ha.dataClient={},Ha.dataUser={}}function K(){var a=n.addDateSimulation(moment(moment()).format("L")),b=n.addDateSimulation(moment(moment().add(15,"days")).format("L"));M(L(a,"/"),L(b,"/"),!0)}function L(a,b){var c=a.split(b);return c[2]+"-"+c[1]+"-"+c[0]}function M(b,c,d){a.datepickerOptions.minDate=moment(b).toDate(),a.datepickerOptions.maxDate=moment(c).toDate(),Ha.datePickerOptions=a.datepickerOptions,Ha.selectedDate||(Ha.selectedDate=moment(b).toDate()),y.$broadcast(w.CHECK_DATES,{maxDate:a.datepickerOptions.maxDate}),a.leftDisabled=!1,a.leftArrowDisabled=!1,a.rightArrowDisabled=!1,a.rightDisabled=!1}function N(){Ha.openModal=d.openModal,Ha.closeModal=d.closeModal,Ha.closeChooseDate=$,Ha.onClickRecalculateInstallments=ba,Ha.onClickSimulator=da,Ha.onClickSend=oa,Ha.goHome=pa,Ha.onDisabledInstallments=ya,Ha.onFocusInput=aa,Ha.onClickInstallments=za,Ha.openModalInfoSCR=S}function O(){var a=C.get();if(_.isEmpty(a)){var b=r.getHeaders();b&&""!==b.TokenCS?f.postOpenshift().then(P).catch(Q):f.post().then(P).catch(Q)}else Ha.dataPreAnalysis=a,R(Ha.dataPreAnalysis)}function P(a){if(204===a.status)return Ga("noPreApproved"),!1;Ha.dataPreAnalysis=a.data,R(Ha.dataPreAnalysis)}function Q(){Ga("error")}function R(a){G.hasBeenInitialized()?Ha.valueMaxSimulator=G.get().valorMaximoFinanciamento:Ha.valueMaxSimulator=a.dadosPreAprovado.valorMaximoFinanciamento,T(),U()}function S(a){a.preventDefault(),Ha.modalConfig.modalInfoSCR.open=!0}function T(){Ha.view.sideBar.name=c.user.user,Ha.view.sideBar.valueMaxSimulator=n.formatMoney(Ha.valueMaxSimulator)}function U(){function a(a){if(204==a.status)return Ga("noPreApproved"),!1;M(a.data.dataMinimaCarenciaFinanciamento,a.data.dataMaximaCarenciaFinanciamento,!0),Ha.dataTermOfFinancing=a.data,Y(),V(30)}function b(){Ga("error")}e.post(15).then(a).catch(b)}function V(a){e.post(a).then(W).catch(X)}function W(a){if(204==a.status)return Ga("noPreApproved"),!1;if(n.getDateDiff(Ha.model.dateSimulator,a.data.dataMinimaCarenciaFinanciamento)<0){var b=a.data.dataMinimaCarenciaFinanciamento,c=moment(b).day();Ha.model.dateSimulator=0===c?moment(b).add(1,"days").format("L"):6===c?moment(b).add(2,"days").format("L"):moment(b).format("L")}Ha.dataTermOfFinancing=a.data,Y()}function X(){Ga("error")}function Y(){o.setDataProduct(document.BVDatalayer),o.callCustomPageView(x.PAGE_NAME_SIMULADOR.DATA,"/simulador"),Z()}function Z(){Ha.loadingPage=!1,Ha.loadingSideBar=!1}function $(){Ha.selectedDate.getTime()>=a.datepickerOptions.minDate.getTime()&&Ha.selectedDate.getTime()<=a.datepickerOptions.maxDate.getTime()&&(Ha.model.dateSimulator=moment(Ha.selectedDate).format("L")),V(n.getDateDiff(Ha.model.dateSimulator,moment(Date.now()).format("L"))),Ha.closeModal(Ha.modalConfig.datepicker)}function aa(){Ha.openModal(Ha.modalConfig.datepicker)}function ba(a){a.preventDefault(),ca("one",!0)}function ca(a,b){var c="one"===a?"two":"one";return Ha.view.step[a]=b,Ha.view.step[c]=!b,Ha.view.disabledInput="one"!==a,"two"===a?na():null}function da(){Ha.view.recalculateInstallments=!0,Ha.installmentSelected.clicked=!1,Ha.view.recalculateInstallments=!0,Ha.view.disabledInput=!0,ea("simulator-installments-spinner"),fa(),Ha.breadcrumbSteps[0].selected=!1,Ha.breadcrumbSteps[0].icon="loan/icon-check",Ha.breadcrumbSteps[1].selected=!0}function ea(a){y.$emit(w.SPINNING_START,{target:a})}function fa(){var a={nuCpfCnpj:Ha.model.cpfCnpj,codigosTermoUso:[1,2]};j.send(a).then(ga).catch(ha)}function ga(a){ia()}function ha(a){Ga("error")}function ia(){var a=la();G.hasBeenInitialized()?(Ha.dataCalcInstallments=G.get().listaParcela,ma()):h.post(a).then(ja).catch(ka)}function ja(a){if(204===a.status)return Ga("noPreApproved"),!1;Ha.dataCalcInstallments=a.data,ma()}function ka(){Ga("error")}function la(){var a=JSON.parse(JSON.stringify(Ha.dataTermOfFinancing.listaPrazosFinanciamento));a.forEach(function(a){delete a.taxaNetAnual,delete a.coeficiente,a.taxa=a.taxaNet,delete a.taxaNet});var b=Ha.model.moneySimulator,c=n.formatDate(Ha.model.dateSimulator);return{codigoTabelaFinanciamento:Ha.dataTermOfFinancing.codigoTabelaFinanciamento,valorProposta:b,parcelas:a,dataPrimeiraParcela:c._i}}function ma(){o.callCustomPageView(x.PAGE_NAME_SIMULADOR.PLAN,"/simulador-parcelas");var a=q.orderListInstallments(Ha.dataCalcInstallments.listaParcelas.parcela);Ha.view.listSuggestions=a.suggestions,null!==a.others&&(Ha.view.hasOptions=!0,Ha.view.listOthers=a.others),ca("two",!0)}function na(){window.setTimeout(function(){D.hash("parcelas"),E()})}function oa(){ea("simulator-spinner"),Ea()}function pa(){var a=s.get();document.leadParla&&document.leadParla.simulator&&(document.leadParla.simulator=!1,0===Object.keys(a).length?k.get().then(qa):ra(a)),sa()}function qa(a){s.set(a.data),ra(a.data)}function ra(a){Ha.dataClient=a,ta()}function sa(){c.goToHome().then(function(a){z.go(a.routeHome,a)}).catch(function(){Ga("error")})}function ta(){var a=t.get();0===Object.keys(a).length?l.get().then(ua).catch(va):wa(a)}function ua(a){t.set(a.data),wa(a.data)}function va(a){wa({})}function wa(a){Ha.dataUser=a,xa()}function xa(){var a="",b={valor:n.formatMoney(Ha.model.moneySimulator),nome:Ha.dataClient.nomeCompleto,cpf:Ha.model.cpfCnpj,email:Ha.dataUser.enderecoEletronico,zip:Ha.dataClient.cep,logradouro:Ha.dataClient.logradouro,cidade:Ha.dataClient.nomeCidade,bairro:Ha.dataClient.bairro,uf:Ha.dataClient.siglaUF},c={};Ha.dataClient&&Ha.dataClient.telefones&&(a=Ha.dataClient.telefones.filter(function(a){return 1===parseInt(a.tipo,10)})[0],a=a?a.ddd+a.numero:""),a.length>0?b.txtPhone=a:Ha.model.userPhoneNumber.length>9&&(b.txtPhone=Ha.model.userPhoneNumber),u.setUserData(b),c=u.getUserData(),i.post(c).then(function(a){})}function ya(){return!Ha.installmentSelected.clicked}function za(a,b){Ha.view.lineSelected=Ha.view.lineSelected.map(function(){return Ha.installmentSelected.clicked=!1,!1}),Ha.view.lineSelected[a]=!0,Ha.installmentSelected.clicked=!0,Ha.model.installmentSelected=b,Ha.installmentSelected.iof=b.valorIof}function Aa(a,b){return"day"===b&&(0===a.getDay()||6===a.getDay())}function Ba(){b.getUserCPF().then(Ca).catch(Da)}function Ca(a){Ha.model.cpfCnpj=a.name}function Da(){Ga("error")}function Ea(){var a={codigoSimulacao:Ha.dataPreAnalysis.codigoSimulacao,valorCredito:Ha.model.moneySimulator,dataPrimVencimento:Ha.model.dateSimulator,opcoesParcelas:Ha.checkBoxInstallments},b=_.clone(Ha.model);b.dateFirstInstallment=b.dateSimulator,b.dateSimulator=moment(Date.now()).format("L"),o.setDataSimulator(document.BVDatalayer,a);var c=p.getDataSidebar(b);m.setDataSiderBar(c);var d=p.getDataForm(b);m.setDataForm(d);var e=Ha.dataTermOfFinancing.listaPrazosFinanciamento.filter(function(a){return a.prazo==b.installmentSelected.quantidadeParcelas}).map(function(a){return b.installmentSelected.coeficiente=a.coeficiente,b.installmentSelected});m.setDataSimulator({installmentSelected:e[0],tableFinance:Ha.dataTermOfFinancing.codigoTabelaFinanciamento,valueTender:b.moneySimulator}),z.go(v.CONTRACT_SEND_TENDER_STEP_ONE)}function Fa(){function a(a){Ha.encrypt.setPublicKey(a.data.key)}function b(){}Ha.encrypt=new JSEncrypt,B.getPublicKey().then(a).catch(b)}function Ga(a){Ha.modalConfig.open=!0,Ha.modalConfig[a].open=!0}var Ha=this;Ha.loadingPage=!0,Ha.loadingSideBar=!0,Ha.watchEvent=!0,Ha.breadcrumbSteps=[{description:"Informe os dados",step:"1",selected:!0},{description:"Confira a simulação",step:"2",selected:!1}],H()}a.$inject=["datepickerManagerService","userService","userInfoService","modalHelpersService","termsOfFinancingServices","preAnalysisServices","calcInstallmentsServices","calcInstallmentsServicesV2","leadParlaService","termOfUseService","getDataClientService","cpDataUserMask","loanStateManagement","loanUtilsFactory","loanDataLayerFactory","simulatorAttributesFactory","simulatorRulesFactory","tokenCSFactory","dataClientFactory","dataUserFactory","leadParlaFactory","loanRoutes","commonEvents","loanConstant","$rootScope","$state","$filter","rsaPublicKeyService","preAnalysisFactory","$location","$anchorScroll","inputMaskChangedFactory","pdecFactory"],angular.module("internetBanking.loan").controller("SimulatorController",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E){function F(){G(),I(),L(),M(),oa(),qa()}function G(){ra.loadingPage=!0,ra.loadingSideBar=!0,ra.watchEvent=!0,ra.breadcrumbSteps=[{description:"Informe os dados",step:"1",selected:!0},{description:"Confira a simulação",step:"2",selected:!1}],ra.totalMonths=6,ra.start=2,ra.end=24,ra.step=1,ra.radioInstallments="outras",ra.loanRoutes=e,ra.view={step:{one:!0,two:!1},formSimulator:{},formModal:{},disabledInput:!1,recalculateInstallments:!1,lineSelected:[!1,!1,!1,!1,!1],listSuggestions:[],listOthers:[],hasOptions:!1,sideBar:{name:"",valueMaxSimulator:""}},ra.model={moneySimulator:"",dateSimulator:moment().format("L"),declaration:!1,userPhoneNumber:""},ra.modalConfig={datepicker:{open:!1,modifierClass:"-datepicker"},error:{open:!1},noPreApproved:{open:!1}},ra.installmentSelected={clicked:!1,installment:{}},ra.disableInvalidDates=na,ra.valueMaxSimulator=0,ra.valueMinSimulator=520,ra.user=l.getUserCached()||{phone:"",email:""},ra.model.userPhoneNumber=ra.user.phone,ra.model.userEmail=ra.user.email,ra.dataClient={},ra.dataUser={},ra.isDisabledSendButton=!1}function H(a){ra.modalConfig.open=!0,ra.modalConfig[a].open=!0}function I(){var a=u.addDateSimulation(moment(moment()).format("L")),b=u.addDateSimulation(moment(moment().add(15,"days")).format("L"));K(J(a,"/"),J(b,"/"),!0)}function J(a,b){var c=a.split(b);return c[2]+"-"+c[1]+"-"+c[0]}function K(b,c,d){j.datepickerOptions.minDate=moment(b).toDate(),j.datepickerOptions.maxDate=moment(c).toDate(),ra.datePickerOptions=j.datepickerOptions,ra.selectedDate||(ra.selectedDate=moment(b).toDate()),a.$broadcast(f.CHECK_DATES,{maxDate:j.datepickerOptions.maxDate}),j.leftDisabled=!1,j.leftArrowDisabled=!1,j.rightArrowDisabled=!1,j.rightDisabled=!1}function L(){ra.closeChooseDate=T,ra.onClickRecalculateInstallments=V,ra.onClickSimulator=X,ra.onClickSend=ga,ra.onClickInstallments=ma,ra.onChangeRadioInstallments=ha,ra.goHome=ia,ra.onFocusInput=U,ra.onUpdateRangeSlider=fa}function M(){function a(a){if(204===a.status)return H("noPreApproved"),!1;ra.dataPreAnalysis=a.data,N(ra.dataPreAnalysis)}function b(){H("error")}var c=y.getHeaders();c&&""!==c.TokenCS?o.postOpenshift().then(a).catch(b):o.post().then(a).catch(b)}function N(a){ra.valueMaxSimulator=a.dadosPreAprovado.valorMaximoFinanciamento,O(),P()}function O(){ra.view.sideBar.name=l.user.user,ra.view.sideBar.valueMaxSimulator=C.numberToCurrency(ra.valueMaxSimulator,"R$ ")}function P(){function a(a){if(204==a.status)return H("noPreApproved"),!1;K(a.data.dataMinimaCarenciaFinanciamento,a.data.dataMaximaCarenciaFinanciamento,!1),ra.dataTermOfFinancing=a.data,R(),Q(30)}function b(){H("error")}n.post(15).then(a).catch(b)}function Q(a){function b(a){if(204==a.status)return H("noPreApproved"),!1;if(u.getDateDiff(ra.model.dateSimulator,a.data.dataMinimaCarenciaFinanciamento)<0){var b=a.data.dataMinimaCarenciaFinanciamento,c=moment(b).day();ra.model.dateSimulator=0===c?moment(b).add(1,"days").format("L"):6===c?moment(b).add(2,"days").format("L"):moment(b).format("L")}ra.dataTermOfFinancing=a.data,R()}function c(){H("error")}n.post(a).then(b).catch(c)}function R(){v.setDataProduct(document.BVDatalayer),v.callCustomPageView(g.PAGE_NAME_SIMULADOR.DATA,"/simulador"),S()}function S(){ra.loadingPage=!1,ra.loadingSideBar=!1}function T(){ra.selectedDate.getTime()>=j.datepickerOptions.minDate.getTime()&&ra.selectedDate.getTime()<=j.datepickerOptions.maxDate.getTime()&&(ra.model.dateSimulator=moment(ra.selectedDate).format("L")),Q(u.getDateDiff(ra.model.dateSimulator,moment(Date.now()).format("L"))),m.closeModal(ra.modalConfig.datepicker)}function U(){m.openModal(ra.modalConfig.datepicker)}function V(a){a.preventDefault(),W("one",!0)}function W(a,b){var c="one"===a?"two":"one";return ra.view.step[a]=b,ra.view.step[c]=!b,ra.view.disabledInput="one"!==a,"two"===a?Y():null}function X(){ra.view.recalculateInstallments=!0,ra.installmentSelected.clicked=!1,ra.view.recalculateInstallments=!0,ra.view.disabledInput=!0,Z("simulator-installments-spinner"),$(),ra.breadcrumbSteps[0].selected=!1,ra.breadcrumbSteps[0].icon="loan/icon-check",ra.breadcrumbSteps[1].selected=!0}function Y(){window.setTimeout(function(){c.hash("parcelas"),d()})}function Z(b){a.$emit(f.SPINNING_START,{target:b})}function $(){function a(a){aa()}function b(a){H("error")}var c={nuCpfCnpj:ra.model.cpfCnpj,codigosTermoUso:[1,2]};r.send(c).then(a).catch(b)}function aa(){var a=da();E.post(a).then(ba).catch(ca)}function ba(a){if(204===a.status)return H("noPreApproved"),!1;ra.dataCalcInstallments=a.data,ea()}function ca(){H("error")}function da(){var a=JSON.parse(JSON.stringify(ra.dataTermOfFinancing.listaPrazosFinanciamento));a.forEach(function(a){delete a.taxaNetAnual,delete a.coeficiente,a.taxa=a.taxaNet,delete a.taxaNet});var b=ra.model.moneySimulator,c=u.formatDate(ra.model.dateSimulator);return{codigoTabelaFinanciamento:ra.dataTermOfFinancing.codigoTabelaFinanciamento,valorProposta:b,parcelas:a,dataPrimeiraParcela:c._i}}function ea(){var a=Math.min.apply(Math,ra.dataCalcInstallments.listaParcelas.parcela.map(function(a){return a.quantidadeParcelas}));v.callCustomPageView(g.PAGE_NAME_SIMULADOR.PLAN,"/simulador-parcelas");var b=x.orderListInstallments(ra.dataCalcInstallments.listaParcelas.parcela);ra.totalMonths=a,ra.start=a,ra.end=Math.max.apply(Math,ra.dataCalcInstallments.listaParcelas.parcela.map(function(a){return a.quantidadeParcelas})),ra.view.listSuggestions=b.suggestions,null!==b.others&&(ra.view.hasOptions=!0,ra.view.listOthers=b.others),W("two",!0),fa()}function fa(){var a=ra.dataCalcInstallments.listaParcelas.parcela.filter(function(a){return a.quantidadeParcelas===ra.totalMonths});ra.model.installmentSelected=a[0]||{}}function ga(){Z("simulator-spinner"),pa()}function ha(a){"outras"===a?(fa(),ra.isDisabledSendButton=!1):(ra.installmentSelected.clicked=!1,ra.isDisabledSendButton=!ra.installmentSelected.clicked)}function ia(){function a(a){z.set(a.data),b(a.data)}function b(a){ra.dataClient=a,ka()}var c=z.get();document.leadParla&&document.leadParla.simulator&&(document.leadParla.simulator=!1,0===Object.keys(c).length?s.get().then(a):b(c)),ja()}function ja(){l.goToHome().then(function(a){b.go(a.routeHome,a)}).catch(function(){H("error")})}function ka(){function a(a){A.set(a.data),c(a.data)}function b(a){c({})}function c(a){ra.dataUser=a,la()}var d=A.get();0===Object.keys(d).length?t.get().then(a).catch(b):c(d)}function la(){var a="",b={valor:C.numberToCurrency(ra.model.moneySimulator,"R$ "),nome:ra.dataClient.nomeCompleto,cpf:ra.model.cpfCnpj,email:ra.dataUser.enderecoEletronico,zip:ra.dataClient.cep,logradouro:ra.dataClient.logradouro,cidade:ra.dataClient.nomeCidade,bairro:ra.dataClient.bairro,uf:ra.dataClient.siglaUF},c={};ra.dataClient&&ra.dataClient.telefones&&(a=ra.dataClient.telefones.filter(function(a){return 1===parseInt(a.tipo,10)})[0],a=a?a.ddd+a.numero:""),a.length>0?b.txtPhone=a:ra.model.userPhoneNumber.length>9&&(b.txtPhone=ra.model.userPhoneNumber),B.setUserData(b),c=B.getUserData(),q.post(c).then(function(a){})}function ma(a,b){ra.view.lineSelected=ra.view.lineSelected.map(function(){return ra.installmentSelected.clicked=!1,!1}),ra.view.lineSelected[a]=!0,ra.installmentSelected.clicked=!0,ra.model.installmentSelected=b,ra.installmentSelected.iof=b.valorIof,ra.isDisabledSendButton=!1}function na(a,b){return"day"===b&&(0===a.getDay()||6===a.getDay())}function oa(){function a(a){ra.model.cpfCnpj=a.name}function b(){H("error")}k.getUserCPF().then(a).catch(b)}function pa(){var a={codigoSimulacao:ra.dataPreAnalysis.codigoSimulacao,valorCredito:ra.model.moneySimulator,dataPrimVencimento:ra.model.dateSimulator,opcoesParcelas:ra.radioInstallments},c=_.clone(ra.model),d={},f={},g=[];c.dateFirstInstallment=c.dateSimulator,c.dateSimulator=moment(Date.now()).format("L"),v.setDataSimulator(document.BVDatalayer,a),d=w.getDataSidebar(c),h.setDataSiderBar(d),f=w.getDataForm(c),h.setDataForm(f),g=ra.dataTermOfFinancing.listaPrazosFinanciamento.filter(function(a){return a.prazo==c.installmentSelected.quantidadeParcelas}).map(function(a){return c.installmentSelected.coeficiente=a.coeficiente,c.installmentSelected}),h.setDataSimulator({installmentSelected:g[0],tableFinance:ra.dataTermOfFinancing.codigoTabelaFinanciamento,valueTender:c.moneySimulator}),b.go(e.CONTRACT_SEND_TENDER_STEP_ONE)}function qa(){function a(a){ra.encrypt.setPublicKey(a.data.key),ra.isEncrypted=!0}function b(){ra.isEncrypted=!1}ra.isEncrypted=!1,ra.encrypt=new JSEncrypt,i.getPublicKey().then(a).catch(b)}var ra=this;F()}
a.$inject=["$rootScope","$state","$location","$anchorScroll","loanRoutes","commonEvents","loanConstant","loanStateManagement","rsaPublicKeyService","datepickerManagerService","userService","userInfoService","modalHelpersService","termsOfFinancingServices","preAnalysisServices","calcInstallmentsServices","leadParlaService","termOfUseService","getDataClientService","cpDataUserMask","loanUtilsFactory","loanDataLayerFactory","simulatorAttributesFactory","simulatorRulesFactory","tokenCSFactory","dataClientFactory","dataUserFactory","leadParlaFactory","numberToCurrencyFactory","inputMaskChangedFactory","calcInstallmentsServicesV2"],angular.module("internetBanking.loan").controller("SimulatorV2Controller",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(){c(g,n),b.$on("$locationChangeStart",h)}function g(){i()}function h(a,b,c){b.indexOf("passo-5")>-1&&(a.preventDefault(),window.history.forward())}function i(){function a(a){j(a)}function b(a){422===a.status?m.attempts<3?(m.attempts++,c(g,n)):(m.loadingPage=!1,m.view.title="Sistema indisponível no momento",m.view.description="Por favor tente mais tarde."):l()}e.check().then(a).catch(b)}function j(b){var e="",f=["AC","AI","ACOM","CRIC","ACCO"];if(213===b.status)e=k(b.status);else if(202===b.status){if(b.data.hasOwnProperty("statusProposta")&&"A"==b.data.statusProposta.toUpperCase())return a.go(d.CONTRACT_SEND_DOCUMENTS),!1;var h=f.filter(function(a){return b.data.status===a});if(h.length>0)return m.attempts++,void(m.attempts<3?c(g,n):(m.loadingPage=!1,m.view.title="Sua proposta está sendo analisada",m.view.description="Por favor volte mais tarde."));e=d.CONTRACT_SEND_DOCUMENTS}""!==e&&a.go(e)}function k(a){var b=document.showLoanSimulatorV2||!1;return d[{201:"CONTRACT_PAYMENT_SUCCESS",202:"CONTRACT_DOCUMENTS_PENDING",204:b?"SIMULATOR_V2":"SIMULATOR",212:"CONTRACT_SEND_DOCUMENTS",213:"CONTRACT_TENDER_REJECT",211:"CONTRACT_PAYMENT_ERROR"}[a]]}function l(){m.modalConfig.open=!0,m.modalConfig.error.open=!0}var m=this,n=2e4;m.loadingPage=!0,m.watchEvent=!0,m.loanRoutes=d,m.attempts=0,m.view={title:"Sua proposta foi enviada!",description:"Aguarde. A análise de crédito pode levar até 2 minutos"},m.modalConfig={open:!1,error:{open:!1}},m.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!1},{description:"Receba o seu dinheiro",step:"3",selected:!1}],f()}a.$inject=["$state","$scope","$timeout","loanRoutes","statusTenderService"],angular.module("internetBanking.loan").controller("ContractTenderProcessController",a)}(),function(){"use strict";function a(a){var b=this;b.commonRoutes=a,b.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!1},{description:"Receba o seu dinheiro",step:"3",selected:!1}]}a.$inject=["commonRoutes"],angular.module("internetBanking.loan").controller("ContractTenderAnalyzedController",a)}(),function(){"use strict";function a(a,b,c){function d(){c.callCustomPageView(b.PAGE_NAME_CONTRACT_YOU_MONEY.DOCUMENT_PENDING)}var e=this;e.commonRoutes=a,e.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!1,icon:"loan/icon-clock"},{description:"Receba o seu dinheiro",step:"3",selected:!1}],d()}a.$inject=["commonRoutes","loanConstant","loanDataLayerFactory"],angular.module("internetBanking.loan").controller("ContractDocumentPendingController",a)}(),function(){"use strict";function a(a,b,c,d){function e(){c.callCustomPageView(d.PAGE_NAME_CONTRACT_YOU_MONEY.REJECT),f.view.name=b.get("nameUser")}var f=this;f.view={name:""},f.commonRoutes=a,e()}a.$inject=["commonRoutes","loanStateManagement","loanDataLayerFactory","loanConstant"],angular.module("internetBanking.loan").controller("ContractTenderRejectController",a)}(),function(){"use strict";function a(a,b,c){function d(){b.callCustomPageView(c.PAGE_NAME_CONTRACT_YOU_MONEY.PAYMENT_PENDING)}var e=this;e.commonRoutes=a,e.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!1,icon:"loan/icon-check"},{description:"Receba o seu dinheiro",step:"3",selected:!1,icon:"loan/icon-clock"}],d()}a.$inject=["commonRoutes","loanDataLayerFactory","loanConstant"],angular.module("internetBanking.loan").controller("ContractPaymentPendingController",a)}(),function(){"use strict";function a(a,b,c){function d(){b.callCustomPageView(c.PAGE_NAME_CONTRACT_YOU_MONEY.ERROR)}var e=this;e.commonRoutes=a,e.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!1,icon:"loan/icon-check"},{description:"Receba o seu dinheiro",step:"3",selected:!1,icon:"loan/icon-exclamation"}],d()}a.$inject=["commonRoutes","loanDataLayerFactory","loanConstant"],angular.module("internetBanking.loan").controller("ContractPaymentErrorController",a)}(),function(){"use strict";function a(a,b,c){function d(){b.callCustomPageView(c.PAGE_NAME_CONTRACT_YOU_MONEY.CONCLUSION)}var e=this;e.commonRoutes=a,e.breadcrumbSteps=[{description:"Envie sua proposta",step:"1",selected:!0,icon:"loan/icon-check"},{description:"Envie seus documentos",step:"2",selected:!1,icon:"loan/icon-check"},{description:"Receba o seu dinheiro",step:"3",selected:!1,icon:"loan/icon-check"}],d()}a.$inject=["commonRoutes","loanDataLayerFactory","loanConstant"],angular.module("internetBanking.loan").controller("ContractPaymentSuccessController",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(f){function g(a){i.resolve(a)}function h(a){i.reject(a)}var i=e.defer(),j={method:"POST",url:a.public+b.PARLA_SERVICE,cache:!1,data:d(f),headers:{"Content-Type":'application/x-www-form-urlencoded; charset=utf-8"'}};return c(j).then(g).catch(h),i.promise}return{post:f}}a.$inject=["appSettings","loanEndPoints","$http","$httpParamSerializerJQLike","$q"],angular.module("internetBanking.loan").service("leadParlaService",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){function d(a){g.resolve(a)}function f(a){g.reject(a)}var g=c.defer(),h={method:"GET",cache:!1,url:a.backEnd+e.STATUS_TENDER};return b(h).then(d).catch(f),g.promise}function l(){var a=i.getParams();a.emprestimo&&("creditopravoce"===a.emprestimo&&m(),"pre-aprovado"===a.emprestimo&&d.go(f.STATUS_TENDER_HOME))}function m(a){j.getSimulationData().then(function(a){return Object.keys(a).length>0?h.open(a):null})}return{check:k,checkQueryParams:l}}a.$inject=["appSettings","$http","$q","$state","loanEndPoints","loanRoutes","userService","tenderService","redirectPageService","simulatorService"],angular.module("internetBanking.loan").service("statusTenderService",a)}(),function(){"use strict";function a(a,b,c,d){function e(e){function f(a){i.resolve(a)}function g(a){i.reject(a)}var h=a.backEndOpenshift+b.SIMULATOR_FINANCING_CONDITIONS+e,i=d.defer();return c({method:"POST",url:h}).then(f).catch(g),i.promise}return{post:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("termsOfFinancingServices",a)}(),function(){"use strict";function a(a,b,c,d){function e(e){function f(a){h.resolve(a)}function g(a){h.reject(a)}var h=d.defer(),i={method:"POST",url:a.backEnd+b.SIMULATOR_CALCULATION_OF_INSTALLMENTS,cache:!1,data:e};return c(i).then(f).catch(g),h.promise}return{post:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("calcInstallmentsServices",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(f){function g(a){i.resolve(a)}function h(a){i.reject(a)}var i=d.defer(),j={method:"POST",url:a.backEndSimuladorCP+b.SIMULATOR_CALCULATION_OF_INSTALLMENTSV2,cache:!1,data:f,headers:e.getHeadersCPF()};return c(j).then(g).catch(h),i.promise}return{post:f}}a.$inject=["appSettings","loanEndPoints","$http","$q","tokenCSFactory"],angular.module("internetBanking.loan").service("calcInstallmentsServicesV2",a)}(),function(){"use strict";function a(a,b,c,d){function e(e){function f(a){i.resolve(a)}function g(a){i.reject(a)}var h=a.publicArea+b.TERMS,i=d.defer();return c({method:"POST",url:h,data:e}).then(f).catch(g),i.promise}return{send:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("termOfUseService",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(){function f(a){h.resolve(a)}function g(a){h.reject(a)}var h=d.defer(),i={method:"GET",cache:!1,url:a.backEndOpenshiftCP+b.MASK_DATAS,headers:e.getHeaders()};return c(i).then(f).catch(g),h.promise}return{get:f}}a.$inject=["appSettings","loanEndPoints","$http","$q","tokenCSFactory"],angular.module("internetBanking.loan").service("cpDataUserMask",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(){function f(a){var b=a.data,c={};Object.keys(b).length>0&&(e.setSimulationData(b),c=e.getSimulationData()),h.resolve(c)}function g(a){h.reject(a)}var h=b.defer(),i={method:"GET",cache:!1,url:c.backEndApcp+d.SIMULATOR_GET_SIMULATION};return a(i).then(f).catch(g),h.promise}return{getSimulationData:f}}a.$inject=["$http","$q","appSettings","loanEndPoints","simulatorFactory"],angular.module("internetBanking.loan").service("simulatorService",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k){function l(a){function b(){var b={user:{cpfCnpj:a.user.cpfCnpj,userPhoneNumber:a.user.userPhoneNumber,userEmail:a.user.email},sidebar:{dateSimulator:a.dateSimulator,dateFirstInstallment:a.dateFirstInstallment,moneySimulator:a.moneySimulator,installmentSelected:d},simulator:{tableFinance:a.tableFinance,valueTender:g.formatMoney(a.moneySimulator),dateSimulator:a.dateSimulator,installmentSelected:d}},h=e.getDataSidebar(b.sidebar),i=e.getDataForm(b.user);f.setDataSiderBar(h),f.setDataForm(i),f.setDataSimulator(b.simulator),k.go(c.CONTRACT_SEND_TENDER_STEP_ONE)}var d=a.installmentSelected;a.user.cpfCnpj?b():h.getUserCPF().then(function(c){a.user.cpfCnpj=c.name,b()})}function m(a){function c(a){g.resolve(a)}function e(a){g.reject(a)}var f=b.backEnd+d.TENDER_SEND,g=j.defer();return i({method:"POST",url:f,data:a}).then(c).catch(e),g.promise}function n(a){function c(a){g.resolve(a)}function e(a){g.reject(a)}var f=b.backEndOpenshift+d.TENDER_SEND_OPENSHIFT,g=j.defer();return i({method:"POST",url:f,data:a}).then(c).catch(e),g.promise}function o(a){function c(a){g.resolve(a)}function e(a){g.reject(a)}var f=b.backEndOpenshift+d.TENDER_SEND_OPENSHIFT_CP,g=j.defer();return i({method:"POST",url:f,data:a}).then(c).catch(e),g.promise}function p(){function a(a){f.resolve(a)}function c(a){f.reject(a)}var e=b.backEnd+d.TENDER_GET,f=j.defer();return i({method:"GET",url:e,cache:!1}).then(a).catch(c),f.promise}return{create:m,createOpenShift:n,createOpenShift2:o,get:p,open:l}}a.$inject=["tokenCSFactory","appSettings","loanRoutes","loanEndPoints","simulatorAttributesFactory","loanStateManagement","loanUtilsFactory","userService","$http","$q","$state"],angular.module("internetBanking.loan").service("tenderService",a)}(),function(){"use strict";function a(a,b,c,d){function e(e){function f(a){i.resolve(a)}function g(a){i.reject(a)}var h=a.publicArea+b.ADDRESS+e,i=d.defer();return c({method:"GET",cache:!1,url:h}).then(f).catch(g),i.promise}return{get:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("getAddressService",a)}(),function(){"use strict";function a(a,b,c,d){function e(){function e(a){h.resolve(a)}function f(a){h.reject(a)}var g=a.publicArea+b.CIVIL_STATUS,h=d.defer();return c({method:"GET",cache:!0,url:g}).then(e).catch(f),h.promise}return{get:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("outherInformationGenderService",a)}(),function(){"use strict";function a(a,b,c,d){function e(){function e(a){h.resolve(a)}function f(a){h.reject(a)}var g=a.publicArea+b.OCCUPATIONS,h=d.defer();return c({method:"GET",cache:!1,url:g}).then(e).catch(f),h.promise}return{get:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("professionalInformationProfessionService",a)}(),function(){"use strict";function a(a,b,c,d){function e(){function e(a){h.resolve(a)}function f(a){h.reject(a)}var g=a.publicArea+b.UFS,h=d.defer();return c({method:"GET",cache:!0,url:g}).then(e).catch(f),h.promise}return{get:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("getUfsService",a)}(),function(){"use strict";function a(a,b,c,d){function e(){function e(a){a.data=a.data.filter(f),i.resolve(a)}function g(a){i.reject(a)}var h=a.backEnd+b.BANKS,i=d.defer();return c({method:"GET",cache:!1,url:h}).then(e).catch(g),i.promise}function f(a){return-1===["002","007","008","022","027","028","031","034","035","038","048","348","019","018","148","175","200","244","039","045","051","109","116","247","00","291","096","210","211","215","219","225","229","230","234","235","424","453","472","480","493","496","501","502","638","738","078","252","275","282","346","347","351","353","998","061","073","192","017","248","069","749","750","388","392","420","641","650","702","721","733","734","101","014","117","080","127","060","011","113","100","013","901","131","015","102","123","130","105","108","093","122","473","040","114","083","477","132","652","074","076","066","079","094","088","120","092","082","119","124","081","095","126","118","129","712","016","111"].indexOf(a.codigoBacen)}return{get:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("bankService",a)}(),function(){"use strict";function a(a,b,c,d){function e(){function e(a){h.resolve(a)}function f(a){h.reject(a)}var g=a.backEnd+b.TYPE_ADDRESS,h=d.defer();return c({method:"GET",cache:!0,url:g}).then(e).catch(f),h.promise}return{get:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("typeAddressService",a)}(),function(){"use strict";function a(a,b,c,d){function e(e){function f(a){i.resolve(a)}function g(a){i.reject(a)}var h=a.backEnd+b.LOAN_CONTRACT_CHECK_LIST_UPLOAD;h=h+"/"+e.numberTender+"/"+e.operator+"/"+e.codeProduct+"/"+e.institution;var i=d.defer();return c({method:"get",cache:!1,url:h}).then(f).catch(g),i.promise}return{get:e}}a.$inject=["appSettings","endPoints","$http","$q"],angular.module("internetBanking.loan").service("checkListDocumentsService",a)}(),function(){"use strict";function a(a,b,c,d,e){function f(e){var f={codigoParceiroComercial:e.codigoParceiro,numeroProposta:e.numeroProposta};return b.post(a.backEnd+d.LOAN_CONTRACT_DOCUMENTLIST_REQUEST,f).then(function(a){return a.data}).catch(function(a){return c.reject(a.data)})}function g(a){e.$emit("errorUpload",a)}function h(){return n}function i(e){return b.post(a.backEnd+d.LOAN_CONTRACT_UPLOAD_DOCUMENT,e).then(function(a){return a.data}).catch(function(a){return c.reject(a.data)})}function j(e){var f={numeroProposta:e.numeroProposta};return b.post(a.backEnd+d.LOAN_CONTRACT_GET_CHECKLIST,f).then(function(a){return a.data}).catch(function(a){return c.reject(a.data)})}function k(e){return b.post(a.backEnd+d.LOAN_CONTRACT_UPDATE_DOCUMENTLIST,e).then(function(a){return a.data}).catch(function(a){return c.reject(a.data)})}function l(e){var f=c.defer();return b.get(a.backEnd+d.LOAN_CONTRACT_GET_UPLOADED_DOCUMENTS+"/"+e).then(function(a){f.resolve(a.data)}).catch(function(a){f.reject(error)}),f.promise}function m(a){return docPendenciesList.listaDocumento.filter(function(b){return a===b.codigoDocumento})[0].descricaoStatus||"Aguardando envio"}var n;return{docErrorHandling:g,getDocumentList:f,getDocumentListPendenciesById:m,getDocError:h,getUploadedDocuments:l,getCheckList:j,uploadDocument:i,updateDocumentList:k}}a.$inject=["appSettings","$http","$q","endPoints","$rootScope"],angular.module("internetBanking.loan").service("uploadDocumentsServiceV2",a)}(),function(){"use strict";function a(a,b,c,d){function e(){function e(a){g.resolve(a)}function f(a){g.reject(a)}var g=d.defer(),h={method:"GET",cache:!1,url:a.backEnd+b.CET_CCB};return c(h).then(e).catch(f),g.promise}return{getCETCCB:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("CETCCBService",a)}(),function(){"use strict";function a(a,b,c,d){function e(e){function f(a){h.resolve(a)}function g(a){h.reject(a)}var h=d.defer(),i={method:"POST",cache:!1,url:a.backEnd+b.SEND_TOKEN,data:e.data};return c(i).then(f).catch(g),h.promise}function f(e){function f(a){h.resolve(a)}function g(a){h.reject(a)}var h=d.defer(),i={method:"POST",cache:!1,url:a.backEnd+b.RESEND_TOKEN,data:e.data};return c(i).then(f).catch(g),h.promise}function g(e){function f(a){h.resolve(a)}function g(a){h.reject(a)}var h=d.defer(),i={method:"POST",url:a.backEnd+b.CONFIRM_OPERATION,data:e.data,headers:{"hst-token":e.token}};return c(i).then(f).catch(g),h.promise}function h(e){function f(a){h.resolve(a)}function g(a){h.reject(a)}var h=d.defer(),i={method:"POST",url:a.backEnd+b.CONFIRM_OPERATION_CP,data:e.data,headers:{"hst-token":e.token}};return c(i).then(f).catch(g),h.promise}return{send:e,resend:f,confirmOperation:g,confirmOperationCP:h}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("contractAuthTokenService",a)}(),function(){"use strict";function a(a,b,c,d){function e(e){function f(a){h.resolve(a)}function g(a){h.reject(a)}var h=d.defer(),i={method:"GET",cache:!1,url:a.backEnd+b.PDEC+"/"+e};return c(i).then(f).catch(g),h.promise}return{get:e}}a.$inject=["appSettings","loanEndPoints","$http","$q"],angular.module("internetBanking.loan").service("PDECService",a)}(),function(){"use strict";function a(a,b){function c(a){return b.numberToCurrency(a,"R$ ")}function d(a,b){return e(a).diff(e(b),"days")}function e(a){return moment(a.split("/").reverse().join("-"))}function f(a){return a.map(function(a){return a.prazo})}function g(a){var b=a.toString().replace(".","").replace(",","").replace("R$ ",""),c=b.substr(b.length-2),d=b.substring(0,b.length-2);return parseFloat(d.concat(".",c))}function h(a){var b=a.split("/"),c=moment(b[2]+"-"+b[1]+"-"+b[0]);return 6==c.day()?c.add(2,"days").format("L"):0==c.day()?c.add(1,"days").format("L"):a}function i(a,b){return a+"x "+c(b)}function j(a,b){return k(a)+" ao mês e "+k(b)+" ao ano"}function k(a){return a.toString().replace(".",",")+"%"}return{formatMoney:c,getDateDiff:d,formatDate:e,getInstallmentList:f,formatNumberMoney:g,addDateSimulation:h,formatValueAndInstallment:i,formatTaxesSidebar:j}}a.$inject=["$state","numberToCurrencyFactory"],angular.module("internetBanking.loan").factory("loanUtilsFactory",a)}(),function(){"use strict";function a(a,b){function c(c,d){var e=d||b.current.url;a.customPageView({pageName:c,url:e})}function d(a){a.product?(a.product.category="emprestimos",a.product.type="creditos",a.product.name="credito pessoal",a.product.detail="credito pessoal BV"):a.product={category:"emprestimos",type:"creditos",name:"credito pessoal",detail:"credito pessoal BV"}}function e(a,b){a.userInfo.idSimulation=b.codigoSimulacao,a.userInfo.statusC="PA",a.userInfo.cidade="",a.userInfo.estado="",a.hasOwnProperty("credito")||(a.credito={}),a.credito.valorCredito=b.valorCredito,a.credito.dataPrimVencimento=b.dataPrimVencimento,a.credito.opcoesParcelas=b.opcoesParcelas}function f(a,b){a.hasOwnProperty("credito")||(a.credito={}),a.credito.seguro=b.seguro,a.credito.valorParcelas=b.valorParcelas,a.credito.numeroParcelas=b.numeroParcelas}function g(a,b){a.userInfo.codArea=b}function h(a,b){a.userInfo.cidade=b.cidade,a.userInfo.estado=b.estado}function i(a,b){a.userInfo.prof=b.prof,a.userInfo.rInf=b.rInf}function j(a,b){a.hasOwnProperty("credito")||(a.credito={}),a.userInfo.idProposta=b.idProposta,a.credito.banco=b.banco,a.credito.tipoPag=b.tipoPag}return{callCustomPageView:c,setDataProduct:d,setDataSimulator:e,setDataTenderStepOne:f,setDataTenderStepTwo:g,setDataTenderStepFour:h,setDataTenderStepFive:i,setDataTenderSend:j}}a.$inject=["dataLayerFactory","$state"],angular.module("internetBanking.loan").factory("loanDataLayerFactory",a)}(),function(){"use strict";function a(a){function b(b){var c=!0,e=d();g={valor:b.valor,nome:b.nome,cpf:b.cpf,email:b.email,zip:b.zip,logradouro:b.logradouro,cidade:b.cidade,bairro:b.bairro,uf:b.uf,status:"Identificado"},e.length>0&&(g.banco=e),b.txtPhone&&b.txtPhone.length>0&&(c=b.txtPhone.match(/(\(|-)/)||!1,g.txtPhone=c?b.txtPhone:a("phone")(b.txtPhone))}function c(a){f=a}function d(){return f}function e(){return Object.assign(h,g)}var f="",g={},h={product:"CREDITO PESSOAL BV",productAS:"Credito Pessoal BV – CANAL SITE BV",productType:"01.04.24.45.01"};return{setBankName:c,setUserData:b,getBankName:d,getUserData:e}}a.$inject=["$filter"],angular.module("internetBanking.loan").factory("leadParlaFactory",a)}(),function(){"use strict";function a(){function a(a){var b=a.cet;return{a:{name:b.a.nome,cpf:b.a.cpf,address:b.a.endereco,income:b.a.renda,patrimony:b.a.patrimonio},b:{operationKind:b.b.tipoOperacao.toLowerCase(),totalCreditAmount:{value:b.b.valorTotalCredito.valor,indice:b.b.valorTotalCredito.indice},totalLiquidAmount:{value:b.b.valorTotalLiquido?b.b.valorTotalLiquido.valor:"",indice:b.b.valorTotalLiquido?b.b.valorTotalLiquido.indice:""},hasCAP:{value:b.b.temSeguroCAP.valor,indice:b.b.temSeguroCAP.indice>0?b.b.temSeguroCAP.indice:"",label:b.b.temSeguroCAP.label.toLowerCase()},CAP:{value:b.b.CAP.valor,indice:b.b.CAP.indice,label:b.b.CAP.label.toLowerCase()},providers:b.b.fornecedores},c:{isFinanced:{value:b.c.eFinanciado.valor,indice:b.c.eFinanciado.indice,label:b.c.eFinanciado.label.toLowerCase()},totalRatesFinanced:{value:b.c.totalTarifasFinanciadas.valor,indice:b.c.totalTarifasFinanciadas.indice}},d:{totalFinancedTaxFree:{value:b.d.totalFinanciadoLivreTaxa.valor,indice:b.d.totalFinanciadoLivreTaxa.indice},hasIOF:{value:b.d.temIOF.valor,indice:b.d.temIOF.indice,label:b.d.temIOF.label},hasAdditionalAliquot:{value:b.d.temAliquotaAdicional.valor,indice:b.d.temAliquotaAdicional.indice,label:b.d.temAliquotaAdicional.label},taxTotalFinanced:{value:b.d.totalFinanciadoLivreTaxa.valor,indice:b.d.totalFinanciadoLivreTaxa.indice},valueTotalIOF:{value:b.d.valortotalIOF.valor,indice:b.d.valortotalIOF.indice},valorImpostoAliquotaIOF:{value:b.d.valorImpostoAliquotaIOF.valor,indice:b.d.valorImpostoAliquotaIOF.indice,label:b.d.valorImpostoAliquotaIOF.label}},e:{firstDuedate:c(b.e.primeiraDataVencimento),installmentLenght:b.e.totalParcelas,paymentKinds:b.e.tiposPagamentos,mounthlyTax:b.e.taxaMensal,yearlyTax:b.e.taxaAnual,installmentAmount:{value:b.e.valorParcela.valor,indice:b.e.valorParcela.indice},totalFinancedAmounthWithTax:{value:b.e.valorTotalFinanciadoComTaxa.valor,indice:b.e.valorTotalFinanciadoComTaxa.indice},totalPaidAmounthAtEnd:{value:b.e.valorTotalPagoAoFinal.valor,indice:b.e.valorTotalPagoAoFinal.indice},mounthlyCET:b.e.CETMensal,yearlyCET:b.e.CETAnual,ExpiryDateBudget:b.e.prazoValidadeOrcamento,address:b.e.local||"",date:b.e.data||"",consumerSignature:b.e.assinaturaConsumidor||""}}}function b(a){var b=a.ccb,g=b.f.pagamentosAutorizados;return{a:{approvementCode:b.aprovacao.codigoAprovacao||""},b:{name:b.b.nome,cpfcnpj:b.b.cpfcnpj,rg:b.b.rg,address:b.b.endereco,neighborhood:b.b.bairro,city:b.b.cidade,state:b.b.estado,cep:b.b.cep,phone:b.b.telefone,celphone:b.b.celular,email:b.b.email,bankData:b.b.dadosBancarios.replace(/, /g,"<br>")},c:b.c||"",d:{operationKind:b.d.tipoOperacao.toLowerCase()||"",totalCreditAmount:"R$ "+b.d.valorTotalCredito.valor,totalLiquidAmount:"R$ "+b.d.valorTotalLiquido.valor,installmentAmount:"R$ "+b.d.valorParcela.valor,installmentLenght:b.d.quantidadeParcelas,installmentFirstOverdue:c(b.d.vencimentoPrimeiraParcela),installmentLastOverdue:c(b.d.vencimentoUltimaParcela)},e:{penalty:b.e.multa+" sobre o valor da parcela",moratoriumInterest:b.e.jurosMoratorios+" a.m",interestRate:b.e.jurosRemuneratorios+" a.m"},f:{annualInterestRate:b.f.taxaJurosAnual,mounthInterestRate:b.f.taxaJurosMensal+" a.m",annualCET:b.f.cETAnual,mounthCET:b.f.cETMensal,authorizedPayments:g,iofValue:d(g),taCValue:e(g),pgtoTotalValue:f(g)},g:b.g.toLowerCase()||"",h:b.h.toLowerCase()||"",i:b.i||"",date:b.data,address:b.local}}function c(a){return a.replace(/-/g,"/")}function d(a){return g("I.O.F. - R$ ",a).match(/I.O.F/),g("I.O.F. - R$ ",a)}function e(a){return g("Tarifa de Cadastro - R$",a).match(/Cadastro/)?a:"R$0,00"}function f(a){return g("PAGAMENTOS AUTORIZADOS - R$",a).match(/AUTORIZADOS/)?g("R$ ",a).replace("I.O.F. - ",""):"R$0,00"}function g(a,b){var c=b.indexOf(a),d=d=b.indexOf("|",c);return b.substring(c,d-1)}return{convertCETAPItoFront:a,convertCCBAPItoFront:b}}angular.module("internetBanking.loan").factory("CETCCBFactory",a)}(),function(){"use strict";function a(a){function b(b){var c=a.formatValueAndInstallment(b.amountInstallment,b.valueInstalment),d=a.formatMoney(b.total),e=a.formatTaxesSidebar(b.interestRate.month,b.interestRate.year),f=a.formatTaxesSidebar(b.cet.month,b.cet.year);return{valueSimulator:a.formatMoney(b.valueTender),valueInstallments:c,dateFirstInstallments:b.dateFirstInstallment,valueSimulatorTotal:d,interestRate:e,cet:f,dateSimulator:b.dateSimulator}}function c(a){e=a}function d(){return e}var e=null;return{getDataSideBar:b,setCacheSideBar:c,getCacheSideBar:d}}a.$inject=["loanUtilsFactory"],angular.module("internetBanking.loan").factory("contractParseDataFactory",a)}(),function(){"use strict";function a(a,d){function e(){v={pessoas:{pessoa:[]},proposta:{}}}function f(){return v}function g(a){var b=h(a),c=p(a);e(),v.pessoas.pessoa.push(b),v.proposta=c}function h(a){var b={tipoPessoa:"F",codigoPapel:1,cpfCnpj:a.form.two.cpf,nome:a.form.one.name,clientePF:{},emails:{email:[]},enderecos:{endereco:[]},telefones:{telefone:[]}};return b.clientePF=i(a),b.emails.email.push(l(a)),b.enderecos.endereco=m(a.form.three.form),b.telefones.telefone=n(a),b}function i(b){var d={nascimento:a.formatDate(b.form.two.dateOfBirth)._i,nacionalidade:b.form.two.nationality,naturalidade:{nome:c(b.form.two.nationalityCity),uf:b.form.two.naturalness},documento:{},sexo:b.form.two.gender,estadoCivil:b.form.two.civilStatus,cpfConjuge:"",nomeMae:b.form.two.mother,profissao:parseInt(b.form.four.profession,10),tipoProfissional:parseInt(b.form.four.occupation,10),matricula:b.form.four.numberBenefit,tipoResidencia:parseInt(b.form.three.form[0].statusStill,10),qtdeMesesResidencia:0,valorPatrimonio:a.formatNumberMoney(b.form.two.equityValue),dadosProfissionais:{dados:[{nomeEmpresa:"",cnpjEmpresa:"",qtdeMesesOcupacao:b.form.four.timeWork,telefoneComercial:{tipo:0,ddd:0,numero:0,ramal:0}}]},receitas:{receita:[]}};return d.documento=j(b),d.receitas.receita.push(k(b)),d}function j(a){return{tipo:1,numero:a.form.two.rg,orgaoExpedidor:a.form.two.issuingOrganizer.toUpperCase(),ufDocumento:a.form.two.ufDocument}}function k(b){return{tipo:1,valor:a.formatNumberMoney(b.form.four.income)}}function l(a){return{tipo:1,endereco:a.form.one.email}}function m(a){return a.map(function(a,b){return{tipo:b>0?3:1,cep:a.cep,logradouro:a.street.indexOf("•")?a.street.replace(/\u2022/g,"*"):a.street,numero:a.number,complemento:a.complement,bairro:a.neighborhood,cidade:{nome:a.city,uf:a.state},correspondencia:a.correspondence}})}function n(a){return o([b(a.form.one.phoneResidential),b(a.form.one.phoneCommercial),b(a.form.one.phoneMobile)])}function o(a){return a.map(function(a,b){return""===a?null:{tipo:b+1,ddd:a.substring(0,2),numero:a.substr(2),ramal:0}}).filter(function(a){return null!==a})}function p(b){var c=d.getDataSimulator(),e=d.getDataSiderBar(),f={tipoCobranca:3==parseInt(b.form.five.paymentType,10)?1:7,dataEntradaProposta:a.formatDate(e.dateSimulator)._i+"T12:00:00Z",tabelaFinanciamento:c.tableFinance,coeficiente:c.installmentSelected.coeficiente,qtdeParcelas:c.installmentSelected.quantidadeParcelas,valorParcela:c.installmentSelected.valorParcelaSemSeguro,valorProposta:a.formatNumberMoney(c.valueTender),taxaCet:c.installmentSelected.taxaNet,vencimentoPrimeiraParcela:a.formatDate(e.dateFirstInstallment)._i+"T12:00:00Z",dadosPagamento:{pagamento:[]}},g=q(b.form.five);return f.dadosPagamento.pagamento.push(g),f}function q(a){return{codigoBanco:parseInt(a.bank,10),agencia:a.officeBank,dvAgencia:"0",conta:a.checkingAccount.replace(/[^a-zA-Z0-9 ]/g,""),dvConta:a.digit.toLowerCase().replace("x","0"),qtdeMesesConta:parseInt(a.timeAcount,10),tipoConta:0,tipoPagamento:0,cpfConta:a.cpf}}function r(a){var b={tipoPessoa:"J",codigoPapel:4,cpfCnpj:a.form.four.cnpj,nome:a.form.one.name,clientePJ:{},telefones:{telefone:[]},enderecos:{endereco:[]}};b.clientePJ=s(a),b.telefones.telefone.push(t(a.form.four.phoneCompany)),b.enderecos.endereco.push(u(a.form.four.address)),v.pessoas.pessoa.push(b),v.pessoas.pessoa[0].clientePF.dadosProfissionais.dados[0]={nomeEmpresa:a.form.four.nameCompany,cnpjEmpresa:a.form.four.cnpj,qtdeMesesOcupacao:a.form.four.timeWork,telefoneComercial:{tipo:2,ddd:a.form.four.phoneCompany.substring(0,2),numero:a.form.four.phoneCompany.substr(2),ramal:0}}}function s(a){return{razaoSocial:"",nomeFantasia:a.form.four.nameCompany,inscricaoEstadual:"",dataAbertura:"",ramoAtividade:"",valorFaturamentoMedio:"",valorCapitalSocial:"",formaConstituicao:"",quantidadeMesesAtividade:parseInt(a.form.four.timeWork,10),cpfPessoaJuridica:a.form.two.cpf}}function t(a){return{tipo:2,ddd:a.substring(0,2),numero:a.substr(2)}}function u(a){return{tipo:2,cep:a.cep,cidade:{nome:"",uf:a.state},bairro:a.neighborhood,complemento:a.complement,logradouro:a.street,numero:a.number,correspondencia:!1}}var v={};return{reset:e,get:f,create:g,addEntrepreneur:r}}function b(a){return a.replace(/\.|\-|\/|[()]|\W+/g,"")}function c(a){return a.search(/[\xC0-\xFF]/g)>-1&&(a=a.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),a}a.$inject=["loanUtilsFactory","loanStateManagement"],angular.module("internetBanking.loan").factory("sendTenderPayloadFactory",a)}(),function(){"use strict";function a(){function a(){return c}function b(){c=angular.copy(d)}var c={},d={one:{name:"",phoneResidential:"",phoneCommercial:"",phoneMobile:"",email:"",declaration:!1},two:{cpf:"",rg:"",issuingOrganizer:"",dateOfBirth:"",mother:"",equityValue:"",nationality:"",naturalness:"",gender:"",civilStatus:"",ufDocument:"",nationalityCity:""},three:{form:[{cep:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",statusStill:"",correspondence:!0}],hasAddressAdditional:!1},four:{occupation:"",profession:"",timeWork:"",income:"",numberBenefit:"",nameCompany:"",cnpj:"",phoneCompany:"",address:{cep:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:""}},five:{favored:"",cpf:"",bank:"",officeBank:"",checkingAccount:"",timeAcount:"",paymentType:"",digit:"",typeAccount:""}};return c=angular.copy(d),{getModel:a,clear:b}}angular.module("internetBanking.loan").factory("sendTenderAttributesFactory",a)}(),function(){"use strict";function a(){function a(a){l=angular.copy(a),d()}function b(a){return l[a]}function c(a){return m[a]}function d(){m.mobile=l.mobile.length>0?e(l.mobile):"",m.email=l.email.length>0?f(l.email):"",m.cpf=l.cpf.length>0?g(l.cpf):"",m.dateOfBirth=l.dateOfBirth.length>0?h(l.dateOfBirth):"",m.zipCode=l.zipCode.length>0?i(l.zipCode):"",m.street=l.street.length>0?j(l.street):""}function e(a){
return"("+a.substring(0,2)+") *****-*"+a.slice(a.length-2)}function f(a){var b=a.substr(0,1),c=a.split("@")[0];return b+"*******"+c.substr(c.length-2)+"@"+a.split("@")[1]}function g(a){return"***.***.***-"+a.slice(a.length-2)}function h(a){return"**/**/**"+a.slice(a.length-2)}function i(a){return a}function j(a){return a}function k(a){return a.form.one.email=a.form.one.email.indexOf("*")>=0?b("email"):a.form.one.email,a.form.one.phoneMobile=a.form.one.phoneMobile.indexOf("*")>=0?b("mobile"):a.form.one.phoneMobile,a.form.two.dateOfBirth=a.form.two.dateOfBirth.indexOf("*")>=0?b("dateOfBirth"):a.form.two.dateOfBirth,a.form.three.form=a.form.three.form.map(function(a,c){return a.cep=a.cep.indexOf("*")>=0?b("zipCode"):a.cep,a.street=a.street,a}),a.form.two.cpf=b("cpf"),a.form.five.cpf=b("cpf"),a}var l={mobile:null,email:null,dateOfBirth:null,zipCode:null,street:null,cpf:null},m={mobile:null,email:null,dateOfBirth:null,zipCode:null,street:null,cpf:null};return{set:a,getData:b,getDataWithMask:c,removeMask:k}}angular.module("internetBanking.loan").factory("maskToDataFormFactory",a)}(),function(){"use strict";function a(){function a(){return"0001"}function b(){return"999999"}function c(){return i}function d(a){h=a}function e(){return h}function f(a){return h.filter(function(b){return b.codigoBacen===a})[0].nome}function g(a){var b=i.filter(function(b){return b.codigoBacen===a});return b.length?b[0].mask:"99999999999"}var h=[],i=[{codigoBacen:"237",name:"BANCO BRADESCO S.A.",mask:"9999999"},{codigoBacen:"001",name:"BANCO DO BRASIL S.A.",mask:"99999999"},{codigoBacen:"341",name:"BANCO ITAU S.A.",mask:"99999"},{codigoBacen:"033",name:"BANCO SANTANDER (BRASIL) S.A.",mask:"99.999999"},{codigoBacen:"104",name:"CAIXA ECONÔMICA FEDERAL",mask:"99999999"}];return{setBankList:d,getBankList:e,getBankName:f,getMaskBank:g,firstingBanks:c,getCodigoBacenPaymentAccount:b,getAgencyNumber:a}}angular.module("internetBanking.loan").factory("bankFactory",a)}(),function(){"use strict";function a(){function a(){return{modalDocument:!1,sidebar:{},openSideBar:!1,formUploadOne:{},formUploadTwo:{},bypassCETCCB:!1,noIconSidebar:!1,uploadError:{name:"",reason:""}}}function b(){return{documentOne:"",documentOneError:"",documentTwo:"",documentTwoError:""}}function c(){return{upload:[{status:!1,showProgress:!1,progressValue:0,showButton:!0,completed:!1,classError:!1,loading:!1,active:!1,reprovado:!1},{status:!1,showProgress:!1,progressValue:0,showButton:!0,completed:!1,classError:!1,loading:!1,active:!1,reprovado:!1}]}}function d(){return{open:!1,uploadSize:{open:!1},uploadPattern:{open:!1},error:{open:!1}}}function e(){return{tender:0,checklist:0}}return{createView:a,createModel:b,createStateUI:c,createModalConfig:d,createCountAttempts:e}}angular.module("internetBanking.loan").factory("uploadOfDocumentsAttributesFactory",a)}(),function(){"use strict";function a(a,b,c){function d(a){e(a)?g=a:console.error("Precisa passar um objeto com os seguintes atributos:{successRoute, prefixEndpoint, numeroPropostaParceria, codigoParceiroComercial}")}function e(a){return 0==["successRoute","prefixEndpoint","numeroPropostaParceria","codigoParceiroComercial"].map(function(b){return!!a.hasOwnProperty(b)}).filter(function(a){return!1===a}).length}function f(){var d={successRoute:g.successRoute,prefixEndpoint:g.prefixEndpoint,kindTokenTransaction:"CONFIRMAR_CONTRATACAO_CREDITO_PESSOAL",pageName:"bv|area-logada|credito|credito-pessoal|documentos|token",dataTransaction:{dadosAceiteDigital:{numeroPropostaParceria:g.numeroPropostaParceria,codigoParceiroComercial:g.codigoParceiroComercial,logAceiteDigital:{dataOcorrencia:c.formatDate(moment().format("L"))._i,sistemaOperacional:b.os+" | "+b.os_version,navegadorInternet:b.browser}}}};a.setDataTransaction(d)}var g=null;return{set:d,sendDataToken:f}}a.$inject=["authTokenFactory","deviceDetector","loanUtilsFactory"],angular.module("internetBanking.loan").factory("authenticationTokenLoanFactory",a)}(),function(){"use strict";function a(a){function b(b,c,d){return{codigoTabelaFinanciamento:b.codigoTabelaFinanciamento,valorProposta:a.formatNumberMoney(c.moneySimulator),listaPrazosFinanciamento:a.getInstallmentList(b.listaPrazosFinanciamento),valorMaximoFinanciamento:d.dadosPreAprovado.valorMaximoFinanciamento,valorMaximoParcela:d.dadosPreAprovado.pmtMaximo,quantidadeDiasCarencia:a.getDateDiff(c.dateSimulator,moment(Date.now()).format("L"))}}function c(a){var b=a.userPhoneNumber.replace(/\D/g,"");return{cpfCnpj:a.cpfCnpj,ddi:"55",phone:b?b.substr(2):null,email:a.userEmail?a.userEmail:"",ddd:b?b.substring(0,2):""}}function d(a){return{valueTender:parseFloat(a.moneySimulator),dateFirstInstallment:a.dateFirstInstallment,amountInstallment:a.installmentSelected.quantidadeParcelas,valueInstalment:a.installmentSelected.valorParcelaSemSeguro,total:a.installmentSelected.valorFinanciamentoSemSeguro,dateSimulator:a.dateSimulator,interestRate:{month:a.installmentSelected.taxaFinanciamentoMensal,year:a.installmentSelected.taxaFinanciamentoAnual},cet:{month:a.installmentSelected.valorPercentualCetMensal,year:a.installmentSelected.valorPercentualCetAnual}}}function e(a){return{cpfCnpj:a.cpfCnpj,mobile:a.userPhoneNumber?a.userPhoneNumber.replace(/\D/g,""):"",email:a.userEmail?a.userEmail:""}}return{getDataParamsSendCalcInstallments:b,getDataParamsSavePhone:c,getDataSidebar:d,getDataForm:e}}a.$inject=["loanUtilsFactory"],angular.module("internetBanking.loan").factory("simulatorAttributesFactory",a)}(),function(){"use strict";function a(){function a(a){var b=angular.copy(a);if(b.length>5){if(6==b.length)return{suggestions:b,others:null};var c=b.shift(),d=b.pop(),e=parseInt(b.length/4,10),f=1;e<2&&(e=1,f=0);var g=[],h=b.map(function(a){return f==e?(f=1,a):(f++,g.push(a),!1)}).filter(function(a){return!1!==a});if(h.length>4){for(var i=[],j=0;j<4;j++)i.push(h[j]);h=i}return h.unshift(c),h.push(d),{suggestions:h,others:g}}return{suggestions:b,others:null}}return{orderListInstallments:a}}angular.module("internetBanking.loan").factory("simulatorRulesFactory",a)}(),function(){"use strict";function a(){function a(a){var b={dateSimulator:a.dtSimulacaoProposta,dateFirstInstallment:a.variaveisSimulacao.dataPrimeiroPagamento,moneySimulator:Number(a.variaveisCliente.valorSolicitado),installmentsNumber:Number(a.variaveisSimulacao.quantidadeParcelas)},d=b.dateSimulator?moment(b.dateSimulator,"YYYY-MM-DD").format("DD/MM/YYYY"):"",e=b.dateFirstInstallment?moment(b.dateFirstInstallment,"YYYY-MM-DD").format("DD/MM/YYYY"):"";c={dateSimulator:d,dateFirstInstallment:e,moneySimulator:b.moneySimulator,tableFinance:a.cdTabelaFinanciamento,installmentSelected:{coeficiente:Number(a.pcCoeficiente),quantidadeParcelas:b.installmentsNumber,valorFinanciamentoSemSeguro:Number(a.variaveisSimulacao.valorFinalSolicitado),valorParcelaSemSeguro:Number(a.variaveisSimulacao.valorParcela),valorFinanciamento:b.moneySimulator,taxaFinanciamentoMensal:Number(a.txFinanciamento),taxaFinanciamentoAnual:Number(a.txFinanciamentoAnual),valorCustos:Number(a.vrTotalCustoOperacao),valorIof:Number(a.vrIof),valorTarifaCadastro:Number(a.vrTarifaCadastro),taxaNet:Number(a.vrCetMensal),valorPercentualCetMensal:Number(a.vrCetMensal),valorPercentualCetAnual:Number(a.vrCetAnual)},user:{name:a.valoresFinais?a.valoresFinais.nomeCliente:"",email:a.valoresFinais?a.valoresFinais.emailCliente:"",cep:a.valoresFinais?a.valoresFinais.cepCliente:"",income:a.variaveisCliente?a.variaveisCliente.valorRendaPrincipal:"",timeWork:a.variaveisCliente?a.variaveisCliente.tempoEmpresa:"",state:a.variaveisCliente?a.variaveisCliente.estado:"",stateId:a.variaveisCliente?a.variaveisCliente.idEstado:"",cpfCnpj:a.nuCpfCnpj,dateOfBirth:a.dtNascimento?moment(a.dtNascimento,"YYYY-MM-DD").format("DD/MM/YYYY"):""}}}function b(){return c}var c={};return{setSimulationData:a,getSimulationData:b}}angular.module("internetBanking.loan").factory("simulatorFactory",a)}(),function(){"use strict";function a(){function a(a){f=a}function b(a){return f}function c(){g=!0}function d(){g=!1}function e(){return g}var f={},g=!1;return{initialized:c,shutDown:d,hasBeenInitialized:e,set:a,get:b}}angular.module("internetBanking.loan").factory("pdecFactory",a)}();